SELECT 
CONCAT(COALESCE(ITEM.SKU,''),'~','WMSFONTANA') AS PROD_KEY,
'LEGACYWMS' AS {{var('column_srcsyskey')}},
MD5 (CONCAT(COALESCE(ITEM.SKU,''),'~','WMSFONTANA')) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
ITEM.LOADDTS AS {{var('column_z3loddtm')}},
ITEM.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
ITEM.ABC_CD AS VELOCITY_CD,
Case when ITEM.ALLOW_OVERPICK_FLAG = 'Y' then 'Y' ELSE 'N' END AS ALLOWABLE_PICK_UP_FLAG,
ITEM.ASSIGNED_RACK_LOCATION AS RACK_LOC_ID,
--case when length(trim(UPPER(ITEM.BASE_UOM)))<1 then {{var('default_mapkey')}} when UPPER (ITEM.BASE_UOM) ='NULL' then  {{var('default_mapkey')}} else UPPER (ITEM.BASE_UOM) end AS BASE_UOM_KEY,
ITEM.BATTERY_COUNT AS BATTERY_CNT,
ITEM.BATTERY_WATT_HOURS AS BATTERY_CAPACITY_VAL,
ITEM.SAP_COUNTRY_OF_ORIGIN AS PROD_ORIG_CNTRY_NAME,
ITEM.BASE_UOM AS UOM_ITEM_NAME,
ITEM.BATTERY_WEIGHT AS BATTERY_WGT,
case when length(trim(UPPER(ITEM.BUSINESS_UNIT)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.BUSINESS_UNIT)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.BUSINESS_UNIT) end AS PROD_BUS_UNIT_LKEY,
Case when ITEM.BYPASS_UPC_CHECKING_FLAG = 'Y' then 'Y' ELSE 'N' END AS INVTY_BYPASS_CHK_FLAG,
ITEM.CANADA_CUSTOMS_CODE AS CAN_TARIFF_CD,
ITEM.CANADA_CUSTOMS_DESCRIPTION AS TARIFF_CD_DESC,
 Case when ITEM.CASE_PICK_FROM_RACK_FLAG = 'Y' then 'Y' ELSE 'N' END AS INVTY_RACK_PICKUP_FLAG,
 Case when ITEM.CODE_39_FLAG = 'Y' then 'Y' ELSE 'N' END AS BARCD_39_FLAG,
ITEM.COMMODITY_CODE AS CMDTY_CD_DESC,
ITEM.CTRL_DT AS RCRD_PROC_DTE,
ITEM.CTRL_USER_ID AS USERID_NAME,
ITEM.DESCRIPTION AS PROD_DESC,
ITEM.DIVISION_CODE AS PROD_DIV_CD,
ITEM.ERROR_CALC_SKIDS AS SKID_CALC_ERR_NBR,
ITEM.EXPIRED_STATUS AS PROD_EXPR_TYP,
 Case when ITEM.EXPIRY_FLAG = 'Y' then 'Y' ELSE 'N' END AS PROD_SHELF_LIFE_FLAG,
 Case when ITEM.EXTENDED_FORKS_REQUIRED = 'Y' then 'Y' ELSE 'N' END AS EXTNL_FORKS_REQ_FLAG,
 Case when ITEM.FLOOR_LOADED_FLAG = 'Y' then 'Y' ELSE 'N' END AS FLOOR_LOD_FLAG,
ITEM.FLOOR_LOADED_STACK_QTY AS STACK_LOD_QTY,
ITEM.FREIGHT_CLASS AS FRT_CLS_NBR,
case when length(trim(UPPER(ITEM.FREIGHT_GROUP)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.FREIGHT_GROUP)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.FREIGHT_GROUP) end AS SHIP_FRT_GRP_LKEY,
case when length(trim(UPPER(ITEM.GTIN_CODE)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.GTIN_CODE)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.GTIN_CODE) end AS PROD_GLB_TRADE_CD_LKEY,
case when length(trim(UPPER(ITEM.HAZMAT_CODE)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.HAZMAT_CODE)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.HAZMAT_CODE) end AS HAZARDOUS_MATL_CD_LKEY,
Case when ITEM.HOT_FLAG = 'Y' then 'Y' ELSE 'N' END AS HOT_SELL_ITEM_FLAG,
ITEM.HOT_PRIORITY AS HOT_CTGY_PRYRT_AMT,
ITEM.HOT_TEXT AS HOT_ID_DESC,
case when length(trim(UPPER(ITEM.INBOUND_PALLET_TYPE)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.INBOUND_PALLET_TYPE)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.INBOUND_PALLET_TYPE) end AS PAL_IBND_TYP_LKEY,
ITEM.INSPECTION_PERCENTAGE AS PROD_INSPECTED_PCT,
ITEM.INV_CTRL_GROUP AS INVTY_CTRL_GRP_ID,
ITEM.INVALID_SCS_STATUS AS SCS_STAT_TYP,
case when length(trim(UPPER(ITEM.ITEM_CATEGORY_GROUP)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.ITEM_CATEGORY_GROUP)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.ITEM_CATEGORY_GROUP) end AS PROD_CTGY_LKEY,
ITEM.ITEM_CODE AS PROD_ID,
ITEM.ITEM_TRACKING  AS PROD_TRK_TYP,
ITEM.KRONOS_TWO_MOVE_CREDIT AS PROD_TRK_CD_NBR,
ITEM.LAST_CC_DT AS LAST_CYCLE_CNT_DTE,
 Case when ITEM.LAST_MEASURE_ACCURATE = 'Y' then 'Y' ELSE 'N' END AS MEASURED_LAST_ACCURATE_FLAG,
ITEM.LAST_MEASURE_DT AS LAST_MEAS_DTE,
ITEM.LAYERS_PER_PALLET AS CARTONS_PAL_NBR,
 Case when ITEM.LOOSE_CTN_FLAG = 'Y' then 'Y' ELSE 'N' END AS LOOSE_CTN_FLAG,
 Case when ITEM.MANUALLY_PALLETIZE_ISS = 'Y' then 'Y' ELSE 'N' END AS MANUAL_PALLETIZATION_FLAG,
ITEM.MATERIAL_PLANNER_NAME AS PLNG_ITEM_NAME,
ITEM.MATERIAL_TYPE_CODE AS MATL_NBR,
ITEM.MINIMUM_ORDER_QTY AS MIN_ORD_QTY,
 Case when ITEM.NEW_SKU_FLAG = 'Y' then 'Y' ELSE 'N' END AS NEW_SKU_FLAG,
ITEM.NMFC_CODE AS NMFC_PROD_CD_NBR,
ITEM.NORMAL_STATUS AS PROD_STAT_TYP,
ITEM.OVERPICK_UOM_QTY AS OVER_PICK_UOM_QTY,
ITEM.PACK_SEPARATE AS SEPARATE_PACKED_PROD_NBR,
ITEM.PALLET_STACK_HEIGHT AS ALLOWABLE_PAL_HGT_NBR,
case when length(trim(UPPER(ITEM.PALLET_TYPE)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.PALLET_TYPE)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.PALLET_TYPE) end AS PAL_TYP_LKEY,
ITEM.PALLETIZE_SEPARATE AS SEPARATE_PALLETS_NBR,
ITEM.PI_CODE AS PHY_INSPCT_CD_NBR,
ITEM.PLANT_ID AS SLOC_ID,
case when length(trim(UPPER(ITEM.PRODUCT_HIERARCHY)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.PRODUCT_HIERARCHY)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.PRODUCT_HIERARCHY) end AS PROD_GRP_LKEY2,
 Case when ITEM.PTL_LIGHTNING_PICK_FLAG = 'Y' then 'Y' ELSE 'N' END AS PICK_TO_LIGHT_SYSTEMS_FLAG,
ITEM.PTL_LIGHTNING_PICK_QTY AS PICK_TO_LIGHT_SYSTEMS_QTY,
ITEM.PURCHASED_STATUS AS PROD_PUR_TYP,
ITEM.PUT_LIST_ID AS PUT_AWAY_PROD_LIST_NBR,
ITEM.SALES_STATUS_CODE AS PROD_SLS_STAT_TYP,
--case when length(trim(UPPER(ITEM.SAP_COUNTRY_OF_ORIGIN)))<1 then {{var('default_mapkey')}} when UPPER (ITEM.SAP_COUNTRY_OF_ORIGIN) ='NULL' then  {{var('default_mapkey')}} else UPPER (ITEM.SAP_COUNTRY_OF_ORIGIN) end AS PROD_ORIG_CNTRY_KEY,
ITEM.SAP_UNIT_OF_MEASURE AS PROD_UOM_VAL,
ITEM.SCATTER_BOX AS SCATTER_BOX_NBR,
ITEM.SECOND_LANGUAGE_DESCRIPTION AS SECOND_LANG_DESC,
case when length(trim(UPPER(ITEM.SEND_TO_ISS)))<1 then {{var('default_mapkey')}} when UPPER( ITEM.SEND_TO_ISS)  ='NULL' then  {{var('default_mapkey')}} else UPPER(ITEM.SEND_TO_ISS) end AS SEND_TO_ISS_LKEY,
Case when ITEM.SHIP_COMPLETE = 'Y' then 'Y' ELSE 'N' END AS SHIP_CMPLT_FLAG,
Case when ITEM.SHIP_SMALL_CARRIER = 'Y' then 'Y' ELSE 'N' END AS SHIP_SM_CARRIER_FLAG,
ITEM.SKU AS SKU_LOC_ID,
ITEM.START_MANU_SERIAL_DT AS MFG_SERL_NBR_START_DTE,
ITEM.STOP_SHIP_DAYS AS STOP_SHIP_DUR_DY_CNT,
ITEM.STORE_EQUAL_AGE AS PROD_STORG_QTY,
ITEM.TOOL_CODE AS TOOL_CD_NBR,
Case when ITEM.TRACK_SERIAL_FLAG = 'Y' then 'Y' ELSE 'N' END AS PROD_TRK_SERL_FLAG,
ITEM.UNIT_COST AS PROD_UNIT_COST,
'WMSFONTANA' AS WMS_SCHEMA_NAME,
ITEM.UPC_CODE AS PROD_EAN_NBR,
ITEM.UPC_CODE_TYPE AS UPC_CODE_TYPE,
Case when ITEM.VERIFY_UPC_CODE = 'Y' then 'Y' ELSE 'N' END AS UPC_VRFY_CD_FLAG
FROM {{source('WMSFONTANA','ITEM')}} ITEM