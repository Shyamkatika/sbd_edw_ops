SELECT
BOMOPCOMPONENT.OPCOMPONENTID AS PROD_BOM_CMPNT_KEY,
'UFIDA' AS {{var('column_srcsyskey')}},
MD5(UPPER(BOMOPCOMPONENT.OPCOMPONENTID)) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
BOMOPCOMPONENT.LOADDTS AS {{var('column_z3loddtm')}},
BOMOPCOMPONENT.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
BOMOPCOMPONENT.BASEQTYN AS ALT_UOM_NUMERAT_VAL,
BOMOPCOMPONENT.BASEQTYD AS ALT_UOM_DENOM_VAL,
case when length(trim(BOMOPCOMPONENT.BOMID))<1 then {{var('default_mapkey')}} when BOMOPCOMPONENT.BOMID IS NULL then  {{var('default_mapkey')}} else (BOMOPCOMPONENT.BOMID) end AS PROD_BOM_PRNT_KEY,
BOMOPCOMPONENT.SORTSEQ AS BOM_CMPNT_SEQ_NBR,
BOMOPCOMPONENT.OPSEQ AS OPERATIONAL_SEQ_NBR,
BOMOPCOMPONENT.COMPONENTID AS CMPNT_PROD_ID,
BOMOPCOMPONENT.EFFBEGDATE AS BOM_VALID_FROM_DTE,
BOMOPCOMPONENT.EFFENDDATE AS BOM_VALID_TO_DTE,
CASE WHEN TO_NUMBER(BOMOPCOMPONENT.FVFLAG) = '1' THEN 'Y' ELSE 'N' END AS FIXED_BATCH_SZ_FLAG,
BOMOPCOMPONENT.COMPSCRAP AS PROD_SCRAP_PCT,
CASE WHEN BOMOPCOMPONENT.BYPRODUCTFLAG = '1' THEN 'Y' ELSE 'N' END AS BY_PROD_FLAG,
BOMOPCOMPONENT.OPTIONSID AS OPTIONAL_PROD_BOM_CMPNT_ID,
BOMOPCOMPONENT.AUXUNITCODE AS AUXILIARY_UNIT_CODE,
BOMOPCOMPONENT.CHANGERATE AS CONV_RATE,
BOMOPCOMPONENT.AUXBASEQTYN AS BASE_AUXILIARY_QTY,
{{var('default_key')}} AS BOM_CTGY_LKEY,
{{var('default_key')}} AS RESIDING_LOC_KEY,
{{var('default_key')}} AS ISS_PLANT_LOC_KEY,
{{var('default_key')}} AS CMPNT_UOM_KEY,
{{var('default_key')}} AS BOM_CMPNT_ITEM_CTGY_LKEY,
{{var('default_key')}} AS CLS_TYP_LKEY,
{{var('default_key')}} AS DOC_TYP_LKEY,
{{var('default_key')}} AS PROD_GRP_LKEY,
{{var('default_key')}} AS PROD_KEY,
{{var('default_key')}} AS QTY_PER_TYP_LKEY,
{{var('default_key')}} AS PROD_GRP_TYP_LKEY,
{{var('default_key')}} AS CMDTY_CD_LKEY,
{{var('default_key')}} AS JOINT_PROD_TYP_LKEY,
{{var('default_key')}} AS PROD_EXPLD_TYP_LKEY,
--{{var('default_key')}} AS PUR_ORG_KEY,
{{var('default_key')}} AS BOM_PROCUR_TYP_LKEY,
{{var('default_key')}} AS LANG_FMT_TYP_LKEY,
--{{var('default_key')}} AS LEADTIME_OFFSET_UOM_KEY,
{{var('default_key')}} AS PROD_OBJ_CTGY_LKEY,
{{var('default_key')}} AS PRODTN_SUPPLY_AREA_LKEY,
{{var('default_key')}} AS PROD_COST_RELVNT_LKEY,
{{var('default_key')}} AS CRNCY_KEY,
{{var('default_key')}} AS ALT_PROD_STRAT_LKEY,
--{{var('default_key')}} AS ALT_DISPLAY_FMT_KEY,
{{var('default_key')}} AS PROD_BOM_CTGY_LKEY,
--{{var('default_key')}} AS FORMULA_KEY,
{{var('default_key')}} AS PROD_BOM_REF_POINT_LKEY,
{{var('default_key')}} AS CMPNT_CNSMPTN_DIST_LKEY,
{{var('default_key')}} AS PRODTN_BOM_LKEY,
{{var('default_key')}} AS PROD_CMPNT_TYP_LKEY,
{{var('default_key')}} AS BUS_UNIT_KEY,
{{var('default_key')}} AS PROD_LN_TYP_LKEY,
{{var('default_key')}} AS BASE_UOM_KEY,
{{var('default_key')}} AS BOM_KEY,
{{var('default_key')}} AS LAST_MTNC_USER_KEY,
{{var('default_key')}} AS PROD_CLS_LKEY,
BOMOPCOMPONENT.PRODUCTTYPE AS PRNT_PROD_TYP
FROM {{source('UFIDA','BOMOPCOMPONENT')}} BOMOPCOMPONENT
