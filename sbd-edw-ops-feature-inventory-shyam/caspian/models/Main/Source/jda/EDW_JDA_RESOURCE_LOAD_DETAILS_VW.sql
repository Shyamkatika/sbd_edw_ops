SELECT 
UPPER(CONCAT(coalesce(RESLOADDETAIL.DMDORDERTYPE::varchar,''),'~',coalesce(RESLOADDETAIL.DMDORDERSEQNUM::varchar,''),'~',coalesce(RESLOADDETAIL.SUPPLYSEQNUM::varchar,''),'~',
coalesce(RESLOADDETAIL.WHENLOADED::varchar,''),'~',coalesce(RESLOADDETAIL.STEPNUM::varchar,''),'~',coalesce(RESLOADDETAIL.PRODUCTIONMETHOD::varchar,''),'~',
coalesce(RESLOADDETAIL.SUPPLYTYPE::varchar,''),'~',coalesce(RESLOADDETAIL.RES::varchar,''),'~',coalesce(RESLOADDETAIL.LOC::varchar,''),'~',
coalesce(RESLOADDETAIL.ITEM::varchar,''))) AS RESOURCE_LOD_DETAILS_KEY,
'JDA' AS {{var('column_srcsyskey')}},
MD5(UPPER(CONCAT(coalesce(RESLOADDETAIL.DMDORDERTYPE::varchar,''),'~',coalesce(RESLOADDETAIL.DMDORDERSEQNUM::varchar,''),'~',coalesce(RESLOADDETAIL.SUPPLYSEQNUM::varchar,''),'~',
coalesce(RESLOADDETAIL.WHENLOADED::varchar,''),'~',coalesce(RESLOADDETAIL.STEPNUM::varchar,''),'~',coalesce(RESLOADDETAIL.PRODUCTIONMETHOD::varchar,''),'~',
coalesce(RESLOADDETAIL.SUPPLYTYPE::varchar,''),'~',coalesce(RESLOADDETAIL.RES::varchar,''),'~',coalesce(RESLOADDETAIL.LOC::varchar,''),'~',
coalesce(RESLOADDETAIL.ITEM::varchar,'')))) AS {{var('column_redhashkey')}},
{{var('default_n')}} AS {{var('column_delfromsrcflag')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
RESLOADDETAIL.LOADDTS AS {{var('column_z3loddtm')}},
RESLOADDETAIL.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
RESLOADDETAIL.CUSTORDLOADQTY AS CUST_ORD_LOD_QTY,
RESLOADDETAIL.DMDNEEDDATE AS DMD_NEED_DTE,
RESLOADDETAIL.DMDORDERSEQNUM AS DMD_ORD_SEQ_NBR,
RESLOADDETAIL.DMDORDERTYPE AS DMD_ORD_TYP,
RESLOADDETAIL.FCSTORDLOADQTY AS FCST_ORD_LOD_QTY,
case when length(trim(UPPER((RESLOADDETAIL.ITEM)))) <1 then {{var('default_mapkey')}} when UPPER(RESLOADDETAIL.ITEM) IS NULL then {{var('default_mapkey')}} else UPPER(RESLOADDETAIL.ITEM) end AS PROD_KEY,
RESLOADDETAIL.LOADDUR AS LOD_DUR,
RESLOADDETAIL.LOADQTY AS LOD_QTY,
case when length(trim(UPPER((RESLOADDETAIL.LOC)))) <1 then {{var('default_mapkey')}} when UPPER(RESLOADDETAIL.LOC) IS NULL then {{var('default_mapkey')}} else UPPER(RESLOADDETAIL.LOC) end AS LOC_KEY,
RESLOADDETAIL.NEEDDATE AS NEED_DTE,
RESLOADDETAIL.OFFSET AS OFFSET_NBR,
RESLOADDETAIL.OPTIONSETNAME AS OPT_SET_NAME,
RESLOADDETAIL.PROCESSID AS PID_NBR,
--case when length(trim(UPPER((RESLOADDETAIL.PRODUCTIONMETHOD)))) <1 then {{var('default_mapkey')}} when UPPER(RESLOADDETAIL.PRODUCTIONMETHOD) IS NULL then {{var('default_mapkey')}} else UPPER(RESLOADDETAIL.PRODUCTIONMETHOD) end AS PRODTN_MTHD_KEY,
UPPER(CONCAT(coalesce(RESLOADDETAIL.PRODUCTIONMETHOD::VARCHAR,''),'~',coalesce(RESLOADDETAIL.ITEM::VARCHAR,''),'~' ,coalesce(RESLOADDETAIL.LOC::VARCHAR,''))) AS PRODTN_MTHD_KEY,
RESLOADDETAIL.RES AS LOD_RESOURCE_NAME,
RESLOADDETAIL.ROUTINGNEEDCOMPLETEDATE AS RTG_NEED_CMPLT_DTE,
RESLOADDETAIL.SCHEDDATE AS SCHED_DTE,
RESLOADDETAIL.SSLOADQTY AS STK_LOD_QTY,
RESLOADDETAIL.STARTDATE AS PLAN_ORD_START_DTE,
RESLOADDETAIL.STEPNUM AS PRODTN_STEP_NBR,
RESLOADDETAIL.SUPPLYORDERNUM AS SUPPLY_ORD_NBR,
RESLOADDETAIL.SUPPLYORDERSEQNUM AS SUPPLY_ORD_SEQ_NBR,
RESLOADDETAIL.SUPPLYQTY AS SUPPLY_QTY,
RESLOADDETAIL.SUPPLYSEQNUM AS SUPPLY_SEQ_NBR,
RESLOADDETAIL.SUPPLYTYPE AS SUPPLY_TYP,
RESLOADDETAIL.WHENLOADED AS LOD_DTE

FROM {{source('JDA', 'RESLOADDETAIL')}} RESLOADDETAIL
