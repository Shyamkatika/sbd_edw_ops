Select
UPPER(CONCAT(coalesce(UDTSKUPROJSTATICWEEKLY.ITEM::varchar,''),'~',coalesce(UDTSKUPROJSTATICWEEKLY.LOC::varchar,''),'~' ,coalesce(UDTSKUPROJSTATICWEEKLY.OPTIONSET::varchar,''),'~' ,coalesce(UDTSKUPROJSTATICWEEKLY.STARTDATE::varchar,''))) AS SUPPLY_PLNG_PROD_PROJECTION_KEY,
'JDA' AS {{var('column_srcsyskey')}},
MD5(UPPER(CONCAT(coalesce(UDTSKUPROJSTATICWEEKLY.ITEM::varchar,''),'~',coalesce(UDTSKUPROJSTATICWEEKLY.LOC::varchar,''),'~' ,coalesce(UDTSKUPROJSTATICWEEKLY.OPTIONSET::varchar,''),'~' ,coalesce(UDTSKUPROJSTATICWEEKLY.STARTDATE::varchar,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
UDTSKUPROJSTATICWEEKLY.LOADDTS AS {{var('column_z3loddtm')}},
UDTSKUPROJSTATICWEEKLY.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
case when length(trim(UPPER(UDTSKUPROJSTATICWEEKLY.LOC)))<1 then {{var('default_mapkey')}} when UPPER (UDTSKUPROJSTATICWEEKLY.LOC) IS NULL then  {{var('default_mapkey')}} else UPPER (UDTSKUPROJSTATICWEEKLY.LOC) end AS LOC_KEY,
case when length(trim(UPPER(UDTSKUPROJSTATICWEEKLY.ITEM)))<1 then {{var('default_mapkey')}} when UPPER (UDTSKUPROJSTATICWEEKLY.ITEM) IS NULL then  {{var('default_mapkey')}} else UPPER (UDTSKUPROJSTATICWEEKLY.ITEM) end AS PROD_KEY,
UDTSKUPROJSTATICWEEKLY.OPTIONSET AS STORE_SKU_PROJECTIONS_OPT_SET,
UDTSKUPROJSTATICWEEKLY.ACTUALINTRANSIN  AS ACT_IN_TRANSITS_IBND_QTY,
UDTSKUPROJSTATICWEEKLY.ACTUALINTRANSOUT AS ACT_IN_TRANSITS_OBND_QTY,
UDTSKUPROJSTATICWEEKLY.ALLOCTOTFCST AS ALLOC_FCST_QTY,
--UDTSKUPROJSTATICWEEKLY.ALTCONSTRCOVDUR AS ALT_CONSTRAINED_CVRG_DY_CNT,   **check with vinay on these
UDTSKUPROJSTATICWEEKLY.ADJFCSTCUSTORDERS AS AUTO_FCST_CUST_ORD_QTY,
UDTSKUPROJSTATICWEEKLY.COMMITINTRANSIN AS COMMIT_LOD_QTY,
UDTSKUPROJSTATICWEEKLY.CONSTRCOVDUR AS CONSTRAINED_CVRG_DUR_DY_CNT,
UDTSKUPROJSTATICWEEKLY.CONSTRPROJAVAIL AS CONSTRAINED_PROJECTED_AVAIL,
UDTSKUPROJSTATICWEEKLY.CONSTRPROJOH AS CONSTRAINED_PROJECTED_ON_HAND,
UDTSKUPROJSTATICWEEKLY.ALTCONSTRPOH AS CONSTRAINED_PROJECTED_ON_HAND_QTY,
UDTSKUPROJSTATICWEEKLY.TOTDMD AS DMD_QTY,
UDTSKUPROJSTATICWEEKLY.DEPDMD AS DPDNT_DMD_QTY,
--UDTSKUPROJSTATICWEEKLY.DEP_DMDREQUIREMENT AS DPDNT_DMD_REQ_QTY,--NA in SF
--UDTSKUPROJSTATICWEEKLY.DISTREQUIREMENT AS DIST_REQ_QTY,--NA in SF
UDTSKUPROJSTATICWEEKLY.FIRMPLANSHIP AS FIRM_PLND_SHIP_AMT,
UDTSKUPROJSTATICWEEKLY.TOTFCST AS FCST_QTY,
UDTSKUPROJSTATICWEEKLY.FCSTCUSTORDERS AS FORECASTS_CUST_ORD_QTY,
UDTSKUPROJSTATICWEEKLY.TOTINTRANSIN AS IN_TRANSITS_QTY,
UDTSKUPROJSTATICWEEKLY.ADJALLOCTOTFCST AS MKT_ACTVTY_FCST_QTY,
UDTSKUPROJSTATICWEEKLY.NONFCSTCUSTORDERS AS NON_FCSTD_CUST_ORD_QTY,
UDTSKUPROJSTATICWEEKLY.TOTINTRANSOUT AS OUT_TRANSITS_QTY,
UDTSKUPROJSTATICWEEKLY.FIRMPLANORDER AS FIRM_PLAN_ORD_QTY,
UDTSKUPROJSTATICWEEKLY.PLANORDERS AS PLAN_ORD_NBR,
UDTSKUPROJSTATICWEEKLY.PLANARRIV AS PLND_ARRIVALS_AMT,
UDTSKUPROJSTATICWEEKLY.PLANPURCH AS PLND_PUR_QTY,
UDTSKUPROJSTATICWEEKLY.PLANSHIP AS PLND_SHIP_AMT,
UDTSKUPROJSTATICWEEKLY.PRODREQUIREMENT AS PRODTN_REQ_QTY,
CASE WHEN UDTSKUPROJSTATICWEEKLY.PROJAVAIL = '1' THEN 'Y' ELSE 'N' END AS PROJECTED_AVAIL_FLAG,
UDTSKUPROJSTATICWEEKLY.PROJOH AS PROJECTED_ON_HAND_QTY,
UDTSKUPROJSTATICWEEKLY.STARTDATE AS PROJECTION_START_DTE,
UDTSKUPROJSTATICWEEKLY.PROCESSDATE AS PROJECTIONS_PROC_DTE,
UDTSKUPROJSTATICWEEKLY.RECARRIV AS RECOMMENDED_ARRVL_SKU_QTY,
UDTSKUPROJSTATICWEEKLY.RECSHIP AS RECOMMENDED_SHIP_QTY,
UDTSKUPROJSTATICWEEKLY.SS AS SFTY_STK_LVL_VAL,
--UDTSKUPROJSTATICWEEKLY.FIRMSCHEDRCPTS AS FIRM_SCHED_RCPT_QTY,--NA in SF
UDTSKUPROJSTATICWEEKLY.SCHEDRCPTS AS SCHED_RCPT_QTY,
UDTSKUPROJSTATICWEEKLY.COVDUR AS SKU_PROJECTION_DUR,
UDTSKUPROJSTATICWEEKLY.TOTARRIV AS SKU_PROJECTIONS_ARRVL_QTY,
UDTSKUPROJSTATICWEEKLY.TOTSHIP AS SKU_PROJECTIONS_SHIP_QTY,
UDTSKUPROJSTATICWEEKLY.STATSS AS STATS_SFTY_STK_QTY,
UDTSKUPROJSTATICWEEKLY.TOTSUPPLY AS SUPPLY_QTY,
--UDTSKUPROJSTATICWEEKLY.TOTSUPPLYREQUIREMENT AS SUPPLY_REQ_QTY,--NA in SF

UDTSKUPROJSTATICWEEKLY.USERID AS SKU_PROJECTION_USER_ID,
UDTSKUPROJSTATICWEEKLY.U_PASTNONFCSTCUSTORDERS AS PAST_NON_FCSTD_CUST_ORD,
UDTSKUPROJSTATICWEEKLY.U_PASTNONFCSTCUSTORDERS AS PAST_TOT_IN_TRANSIT_OUT,

UDTSKUPROJSTATICWEEKLY.DUR AS TM_INTV_DY_CNT
--UDTSKUPROJSTATICWEEKLY.WOLOAD AS WORK_ORD_NBR --NA in SF
FROM {{source('JDA','UDTSKUPROJSTATICWEEKLY')}} UDTSKUPROJSTATICWEEKLY