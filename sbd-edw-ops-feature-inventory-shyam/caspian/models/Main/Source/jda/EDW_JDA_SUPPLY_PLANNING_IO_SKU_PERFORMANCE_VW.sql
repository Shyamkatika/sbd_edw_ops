Select
UPPER(CONCAT(coalesce(IOSKUPERFORMANCE.ITEM::varchar,''),'~',coalesce(IOSKUPERFORMANCE.LOC::varchar,''),'~' ,coalesce(IOSKUPERFORMANCE.PLANID::varchar,''),'~' ,coalesce(IOSKUPERFORMANCE.EFF::varchar,''))) AS SUPPLY_PLNG_IO_SKU_PERFORM_KEY,
'JDA' AS {{var('column_srcsyskey')}},
MD5(UPPER(CONCAT(coalesce(IOSKUPERFORMANCE.ITEM::varchar,''),'~',coalesce(IOSKUPERFORMANCE.LOC::varchar,''),'~' ,coalesce(IOSKUPERFORMANCE.PLANID::varchar,''),'~' ,coalesce(IOSKUPERFORMANCE.EFF::varchar,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
IOSKUPERFORMANCE.LOADDTS AS {{var('column_z3loddtm')}},
IOSKUPERFORMANCE.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
case when length(trim(UPPER(IOSKUPERFORMANCE.ITEM)))<1 then {{var('default_mapkey')}} when UPPER (IOSKUPERFORMANCE.ITEM) IS NULL then  {{var('default_mapkey')}} else UPPER (IOSKUPERFORMANCE.ITEM) end AS PROD_KEY,
case when length(trim(UPPER(IOSKUPERFORMANCE.LOC)))<1 then {{var('default_mapkey')}} when UPPER (IOSKUPERFORMANCE.LOC) IS NULL then  {{var('default_mapkey')}} else UPPER (IOSKUPERFORMANCE.LOC) end AS LOC_KEY,
IOSKUPERFORMANCE.PLANID AS PLAN_NUM,
IOSKUPERFORMANCE.EFF AS EFF_DT,
IOSKUPERFORMANCE.APPROVALSTATUS AS APRV_STAT,
IOSKUPERFORMANCE.DUR AS DUR,
IOSKUPERFORMANCE.REORDERPOINT AS REORD_PT,
IOSKUPERFORMANCE.SAFETYSTOCK AS SFTY_STK,
IOSKUPERFORMANCE.LEADTIMEDMD AS LEAD_TM_DMD,
IOSKUPERFORMANCE.LEADTIMEDMDSD AS LEAD_TM_DMD_STD_DEVN,
IOSKUPERFORMANCE.LASTAPPROVEDTARGET AS LAST_APRV_TGT,
IOSKUPERFORMANCE.ACCEPTEDTARGET AS ACCPT_TGT,
IOSKUPERFORMANCE.OPTIMALTARGET AS OPTIMAL_TGT,
IOSKUPERFORMANCE.EXPECTEDSL AS EXPCT_SVC_LVL,
IOSKUPERFORMANCE.PCTCHANGE AS PCT_CHG,
IOSKUPERFORMANCE.MEANDAILYDMD AS AVG_DYLY_DMD,
IOSKUPERFORMANCE.MEANDAILYINDDMD AS AVG_IDPDNT_DYLY_DMD,
IOSKUPERFORMANCE.REORDERQTY AS REORD_QTY,
IOSKUPERFORMANCE.ORDERUPTOLEVEL AS ORD_UPTO_LVL,
IOSKUPERFORMANCE.REPAIRCOST AS REPAIR_COST,
IOSKUPERFORMANCE.TRANSCOST AS TRNSPRT_COST,
IOSKUPERFORMANCE.INVINVST AS INVTY_INVST,
IOSKUPERFORMANCE.BACKORDERPENALTY AS BKORD_PENALTY,
IOSKUPERFORMANCE.HOLDINGCOST AS HDLNG_COST,
IOSKUPERFORMANCE.UNITHANDLINGCOST AS UNIT_HDLNG_COST,
IOSKUPERFORMANCE.INVORDERCOST AS INVTY_ORD_COST,
IOSKUPERFORMANCE.PURCHFACTOR AS PUR_FACTOR,
IOSKUPERFORMANCE.AVGPURCHCOST AS AVG_PUR_COST,      
IOSKUPERFORMANCE.GROUPNAME AS GRP_NAME,
IOSKUPERFORMANCE.REVIEWGROUP AS RVW_GRP ,      
IOSKUPERFORMANCE.LASTMEANDAILYDMD AS LAST_AVG_DYLY_DMD,  
IOSKUPERFORMANCE.DMDORDERCOST AS DMD_ORD_COST,     
IOSKUPERFORMANCE.DMDPURCHCOST AS DMD_PUR_COST,     
IOSKUPERFORMANCE.UNITPROCESSCOST AS UNIT_PROC_COST,   
IOSKUPERFORMANCE.UNITTRANSCOST AS UNIT_TRNSPRT_COST,     
IOSKUPERFORMANCE.TOTEVENTSTOCK AS TOT_EVNT_STK,     
IOSKUPERFORMANCE.CWT AS CUST_WAIT_TM,           
IOSKUPERFORMANCE.CWTSD AS CUST_WAIT_TM_STD_DEVN,            
IOSKUPERFORMANCE.INDDMDSS AS IDPDNT_DMD_SFTY_STK,          
IOSKUPERFORMANCE.RQSNCWT AS REQ_AVG_WAIT_TM,      
IOSKUPERFORMANCE.TOTCOST AS TOT_COST 
FROM {{source('JDA','IOSKUPERFORMANCE')}} IOSKUPERFORMANCE