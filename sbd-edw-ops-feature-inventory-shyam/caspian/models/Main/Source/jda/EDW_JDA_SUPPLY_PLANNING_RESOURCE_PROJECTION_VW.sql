SELECT 
UPPER(CONCAT(coalesce(RESPROJSTATIC.LOC::VARCHAR,''),'~',coalesce(RESPROJSTATIC.OPTIONSET::VARCHAR,''),'~' ,coalesce(RESPROJSTATIC.RES::VARCHAR,''),'~' ,coalesce(RESPROJSTATIC.STARTDATE::VARCHAR,''))) AS SUPPLY_PLNG_RESOURCE_PROJECTION_KEY,
'JDA' AS {{var('column_srcsyskey')}},
MD5(UPPER(CONCAT(coalesce(RESPROJSTATIC.LOC::VARCHAR,''),'~',coalesce(RESPROJSTATIC.OPTIONSET::VARCHAR,''),'~' ,coalesce(RESPROJSTATIC.RES::VARCHAR,''),'~' ,coalesce(RESPROJSTATIC.STARTDATE::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
RESPROJSTATIC.LOADDTS AS {{var('column_z3loddtm')}},
RESPROJSTATIC.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
RESPROJSTATIC.AVAILCAP AS AVAIL_CAPACITY_QTY,
RESPROJSTATIC.CHGCOST AS CHG_COST_PRC,
RESPROJSTATIC.MPCHANGEOVERLOAD AS CHG_OVERLOAD_VAL,
RESPROJSTATIC.CPPTOTLOAD AS CHANGEOVER_PRODTN_LOD_VAL,
RESPROJSTATIC.DISTREQUIREMENTLOAD AS DIST_REQ_LOD_VAL,
RESPROJSTATIC.FIRMARRIVALREQUIREMENTLOAD AS FIRM_ARRVL_REQ_LOD_VAL,
RESPROJSTATIC.FIRMPLANORDERREQUIREMENTLOAD AS FIRM_PLAN_ORD_REQ_LOD_VAL,
RESPROJSTATIC.IDEALUTILIZATION AS IDEAL_UTILIZATION_VAL,
RESPROJSTATIC.PCTUSED AS LOD_PCT_VAL,
RESPROJSTATIC.MPFIRMPLANARRIVLOAD AS MSTR_PLNG_FIRM_PLND_ARRVL_LOD_VAL,
RESPROJSTATIC.MPFIRMPOLOAD AS MSTR_PLNG_FIRM_PLND_ORD_LOD_VAL,
RESPROJSTATIC.MPFIRMRECSHIPLOAD AS MSTR_PLNG_FIRM_RECOMMENDED_SHIP_LOD_VAL,
RESPROJSTATIC.MPPOLOAD AS MSTR_PLNG_PLND_ORD_LOD_1_VAL,
RESPROJSTATIC.MPREGULARCAP AS MSTR_PLNG_PLND_ORD_LOD_2_VAL,
RESPROJSTATIC.MPRECSHIPLOAD AS MSTR_PLNG_RECOMMENDED_SHIP_LOD_VAL,
RESPROJSTATIC.MPSCHEDRCPTLOAD AS MSTR_PLNG_SCHED_RCPT_LOD_VAL,
RESPROJSTATIC.MPTOTLOADCUSTORDER AS MSTR_PLNG_TOT_LOD_CUST_ORD_VAL,
RESPROJSTATIC.MPTOTLOADFCSTORDER AS MSTR_PLNG_TOT_LOD_FCST_ORD_VAL,
RESPROJSTATIC.MPTOTLOADSSORDER AS MSTR_PLNG_TOT_LOD_SFTY_STK_ORD_VAL,
RESPROJSTATIC.MPTOTLOAD AS MSTR_PLNG_TOT_LOD_VAL,
RESPROJSTATIC.MPTOTLOADUNCOMM AS MSTR_PLNG_TOT_UNCOMMITTED_LOD_VAL,
RESPROJSTATIC.MPVEHLOADLINELOAD AS MSTR_PLNG_VHCL_LOD_LN_LOD_VAL,
RESPROJSTATIC.MAXUTILIZATION AS MAX_UTILIZATION_VAL,
RESPROJSTATIC.MINUTILIZATION AS MIN_UTILIZATION_VAL,
RESPROJSTATIC.OPTIONSET AS OPT_SET_NAME,
RESPROJSTATIC.OVERTIMEAVAILCAP AS OVER_TM_AVAIL_CAPACITY,
RESPROJSTATIC.MPOVERTIMECAP AS OVTM_CAPACITY_VAL,
RESPROJSTATIC.MPOVERTIMELOAD AS OVTM_LOD_VAL,
RESPROJSTATIC.MPPLANARRIVLOAD AS PLAN_ARRIVALS_LOD_VAL,
RESPROJSTATIC.PLANNEDSUPPLYORDERLOAD AS PLND_SUPPLY_ORD_LOD_VAL,
RESPROJSTATIC.CPPOVERCAP AS PRODTN_PLNG_CAPACITY_OVERLOAD_VAL,
RESPROJSTATIC.CPPLOADFIRMORDER AS PRODTN_PLNG_FIRM_PLND_ORD_LOD_VAL,
RESPROJSTATIC.CPPLOADPLANORDER AS PRODTN_PLNG_PLND_ORD_LOD_VAL,
RESPROJSTATIC.RESCOST AS PRODTN_PLNG_RESOURCE_COST,
RESPROJSTATIC.CPPLOADSCHEDRCPT AS PRODTN_PLNG_SCHED_RCPT_LOD_VAL,
RESPROJSTATIC.CPPTOTLOADCHG AS PRODTN_PLNG_TOT_CHANGEOVER_LOD_VAL,
RESPROJSTATIC.CPPUNUSEDCAP AS PRODTN_PLNG_UNUSED_CAPACITY_QTY,
RESPROJSTATIC.CPPCOSTSKUPROD AS PRODTN_PLNG_PRODTN_COST_PRC,
RESPROJSTATIC.CPPCOSTRESUTIL AS PRODTN_PLNG_RESOURCE_UTILIZATION_COST_PRC,
RESPROJSTATIC.CPPTOTLOADPROD AS PRODTN_PLNG_TOT_CAPACITY_CONSUMED_QTY,
RESPROJSTATIC.CPPTOTCAP AS PRODTN_PLNG_TOT_CAPACITY_QTY,
RESPROJSTATIC.PRODREQUIREMENTLOAD AS PRODTN_REQ_LOD_VAL,
case when length(trim(RESPROJSTATIC.RES))<1 then {{var('default_mapkey')}} when RESPROJSTATIC.RES IS NULL then  {{var('default_mapkey')}} else (RESPROJSTATIC.RES) end AS PROJECTION_RESOURCE_KEY,
RESPROJSTATIC.MPREGULARLOAD AS REGULAR_LOD_VAL,
RESPROJSTATIC.REQUIREMENTPLANAVAILCAP AS REQ_PLAN_AVAIL_CAPACITY,
RESPROJSTATIC.RESSOURCEEXCEPTION AS RESOURCE_EXCEPTION_LOD_VAL,
RESPROJSTATIC.RESCOUNTEXCEPTION AS RESOURCE_EXCEPTIONS_CNT,
case when length(trim(RESPROJSTATIC.LOC))<1 then {{var('default_mapkey')}} when RESPROJSTATIC.LOC IS NULL then  {{var('default_mapkey')}} else (RESPROJSTATIC.LOC) end AS RESOURCE_LOC_KEY,
RESPROJSTATIC.USERID AS RESOURCE_PROJECTION_EXECUTE_USER_ID,
TRY_TO_TIMESTAMP_NTZ(replace(RESPROJSTATIC.PROCESSDATE,'"',''),'YYYY-MM-DD HH24:MI:SS.FF') AS RESOURCE_PROJECTION_PROC_DTE,
TRY_TO_TIMESTAMP_NTZ(replace(RESPROJSTATIC.STARTDATE,'"',''),'YYYY-MM-DD HH24:MI:SS.FF') AS RESOURCE_PROJECTION_START_DTE,
RESPROJSTATIC.DUR AS RESOURCE_TM_INTV_DUR_WK_CNT,
RESPROJSTATIC.SCHEDRCPTSREQUIREMENTLOAD AS SCHED_RCPT_REQ_LOD_VAL,
RESPROJSTATIC.STORAGELOAD AS STORG_LOD_VAL,
RESPROJSTATIC.TOTALREQUIREMENTLOAD AS TOT_REQ_LOD_VAL,
RESPROJSTATIC.TOTLOAD AS TOT_RESOURCE_LOD_VAL,
RESPROJSTATIC.VEHICLELOADLINEREQUIREMENTLOAD AS VHCL_LOD_LN_REQ_LOD_VAL,
RESPROJSTATIC.WORKORDERLOAD AS WORK_ORD_LOD_VAL
FROM {{source('JDA','RESPROJSTATIC')}} RESPROJSTATIC