SELECT
UPPER(concat(COALESCE(SKUPLANNINGPARAM.ITEM,''),'~',COALESCE(SKUPLANNINGPARAM.LOC,'')))	AS	SKU_PLNG_PARM_KEY	,
'JDA' AS {{var('column_srcsyskey')}}	,
UPPER(concat(COALESCE(SKUPLANNINGPARAM.ITEM,''),'~',COALESCE(SKUPLANNINGPARAM.LOC,''))) AS {{var('column_redhashkey')}},
{{var('default_n')}} AS {{var('column_delfromsrcflag')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
SKUPLANNINGPARAM.LOADDTS AS {{var('column_z3loddtm')}},
SKUPLANNINGPARAM.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
SKUPLANNINGPARAM.AGGEXCESSSUPPLYRULE	AS	AGRT_EXCESS_SUPPLY_RULE	,
SKUPLANNINGPARAM.AGGSKURULE	AS	AGRT_SKU_RULE	,
SKUPLANNINGPARAM.AGGUNDERSUPPLYRULE	AS	AGRT_UNDER_SUPPLY_RULE	,
case when SKUPLANNINGPARAM.ALLOCBATCHSW = '1' THEN 'Y' ELSE 'N' END AS ALLOC_BATCH_FLAG,
---SKUPLANNINGPARAM.ALLOCBATCHSW	AS	ALLOC_BATCH_FLAG	, --0,1
SKUPLANNINGPARAM.ATPDUR	AS	AVAIL_PROMISE_DUR_DY_CNT	,
SKUPLANNINGPARAM.ATPRULE	AS	AVAIL_PROMISE_RULE	,
SKUPLANNINGPARAM.BUFFERLEADTIME	AS	BUFFER_LEADTIME_DY_CNT	,---
SKUPLANNINGPARAM.CAMPAIGNMINPRODDUR	AS	CAMPAIGN_MIN_PRODTN_DUR	,
SKUPLANNINGPARAM.CMPFIRMDUR	AS	CMP_FIRM_DUR	,
SKUPLANNINGPARAM.CONSTRINVOPT	AS	CONSTRAINT_INVTY_OPT	,
SKUPLANNINGPARAM.CONSTRSUPPLYALLOCRULE	AS	CONSTRAINT_SUPPLY_ALLOC_RULE	,
SKUPLANNINGPARAM.COSTUOM as UOM_COST,
---SKUPLANNINGPARAM.COSTUOM	AS	COST_UOM_KEY	,
case when SKUPLANNINGPARAM.CPPLOCKSW = '1' THEN 'Y' ELSE 'N' END AS CONSTRAINT_PRODTN_PLNG_LOCK_FLAG,
---SKUPLANNINGPARAM.CPPLOCKSW	AS	CONSTRAINT_PRODTN_PLNG_LOCK_FLAG	, --0,1
SKUPLANNINGPARAM.CPPPRIORITY	AS	CONSTRAINT_PRODTN_PLNG_PRYRT_NBR	,
SKUPLANNINGPARAM.CUMLEADTIMEADJDUR	AS	CUML_LEADTIME_ADJ_DUR	,
SKUPLANNINGPARAM.CUMLEADTIMEDUR	AS	CUML_LEADTIME_DUR	,
SKUPLANNINGPARAM.CUMLEADTIMERULE	AS	CUML_LEADTIME_RULE	,
SKUPLANNINGPARAM.DEPDMDOPT	AS	DPDNT_DMD_OPT	,
SKUPLANNINGPARAM.DRPCOVDUR	AS	PLNG_CVRG_DUR	,
SKUPLANNINGPARAM.DRPFRZDUR	AS	PLNG_FREEZE_DUR	,
SKUPLANNINGPARAM.DRPRULE	AS	PLNG_RULE	,
SKUPLANNINGPARAM.DRPTIMEFENCEDATE	AS	PLNG_TM_FENCE_END_DTE	,
SKUPLANNINGPARAM.DRPTIMEFENCEDUR	AS	PLNG_TM_FENCE_DUR	,
SKUPLANNINGPARAM.EOQ	AS	ECONOMIC_ORD_QTY	,
SKUPLANNINGPARAM.EXPDATE	AS	PLNG_EXPR_DTE	,
--SKUPLANNINGPARAM.EXTERNALSKUSW	AS	EXTNL_SKU_FLAG	, --0,1
case when SKUPLANNINGPARAM.EXTERNALSKUSW = '1' THEN 'Y' ELSE 'N' END AS EXTNL_SKU_FLAG,
SKUPLANNINGPARAM.FIRSTREPLENDATE	AS	FIRST_REPL_DTE	,
SKUPLANNINGPARAM.FWDBUYMAXDUR	AS	FORWARD_BUY_MAX_DUR	, --COLUMN DOES NOT EXIST 
SKUPLANNINGPARAM.HOLDINGCOST	AS	UNIT_HOLDING_COST_PRC	,
SKUPLANNINGPARAM.INCDRPQTY	AS	INCREMENTAL_DRP_PLNG_QTY	,
SKUPLANNINGPARAM.INCMPSQTY	AS	INCREMENTAL_MPS_PLNG_QTY	,
SKUPLANNINGPARAM.INHANDLINGCOST	AS	RCV_HDLNG_COST_PRC	,
case when length(trim(UPPER((SKUPLANNINGPARAM.ITEM)))) <1 then {{var('default_mapkey')}} when UPPER(SKUPLANNINGPARAM.ITEM)
IS NULL then {{var('default_mapkey')}} else UPPER(SKUPLANNINGPARAM.ITEM) end as PROD_KEY,
---SKUPLANNINGPARAM.ITEM	AS	PROD_KEY	,
SKUPLANNINGPARAM.LASTFRZSTART	AS	LAST_FREEZE_START_DTE	,
SKUPLANNINGPARAM.LASTPLANSTART	AS	LAST_PLAN_START_DTE	,
SKUPLANNINGPARAM.LIMITPLANARRIVPUBLISHDUR	AS	PLND_ARRVL_RCRD_DUR	,
case when SKUPLANNINGPARAM.LIMITPLANARRIVPUBLISHSW = '1' THEN 'Y' ELSE 'N' END AS PLND_ARRVL_RCRD_PUBLISH_FLAG,
---SKUPLANNINGPARAM.LIMITPLANARRIVPUBLISHSW	AS	PLND_ARRVL_RCRD_PUBLISH_FLAG	, --0,1
case when length(trim(UPPER((SKUPLANNINGPARAM.LOC)))) <1 then {{var('default_mapkey')}} when UPPER(SKUPLANNINGPARAM.LOC)
IS NULL then {{var('default_mapkey')}} else UPPER(SKUPLANNINGPARAM.LOC) end AS LOC_KEY,
---SKUPLANNINGPARAM.LOC	AS	LOC_KEY	,
SKUPLANNINGPARAM.LOOKAHEADDUR	AS	LOOK_AHEAD_DUR	,
SKUPLANNINGPARAM.MAXCOVDUR	AS	MAX_CVRG_DUR	,
SKUPLANNINGPARAM.MAXOH	AS	MAX_ON_HAND_QTY	,
SKUPLANNINGPARAM.MAXOHRULE	AS	MAX_ON_HAND_RULE	,
SKUPLANNINGPARAM.MFGFRZDUR	AS	MFG_FREEZE_DUR	,
SKUPLANNINGPARAM.MFGLEADTIME	AS	MFG_LEADTIME_DY_CNT	,
SKUPLANNINGPARAM.MINDRPQTY	AS	MIN_DRP_PLNG_QTY	,
SKUPLANNINGPARAM.MINMPSQTY	AS	MIN_MPS_PLNG_QTY	,
SKUPLANNINGPARAM.MPSCOVDUR	AS	MPS_COVERED_DUR	,
SKUPLANNINGPARAM.MPSRULE	AS	MPS_PLNG_RULE	,
SKUPLANNINGPARAM.MPSTIMEFENCEDATE	AS	MPS_TM_FENCE_END_DTE	,
SKUPLANNINGPARAM.MPSTIMEFENCEDUR	AS	MPS_TM_FENCE_DUR	,
SKUPLANNINGPARAM.ORDERINGCOST	AS	ORD_FIXED_COST_PRC	,
SKUPLANNINGPARAM.ORDERPOINTMINDUR	AS	ORD_POINT_MIN_DUR	,
SKUPLANNINGPARAM.ORDERPOINTMINQTY	AS	ORD_POINT_MIN_QTY	,
SKUPLANNINGPARAM.ORDERPOINTMINRULE	AS	ORD_POINT_MIN_RULE	,
SKUPLANNINGPARAM.ORDERPOINTRULE	AS	ORD_POINT_RULE	,
case when SKUPLANNINGPARAM.ORDERSKUDETAILSW = '1' THEN 'Y' ELSE 'N' END AS ORD_SKU_DTL_POPULATE_FLAG,
---SKUPLANNINGPARAM.ORDERSKUDETAILSW	AS	ORD_SKU_DTL_POPULATE_FLAG	, --0,1
SKUPLANNINGPARAM.ORDERUPTOLEVELMAXDUR	AS	ORD_LVL_MAX_DUR	,
SKUPLANNINGPARAM.ORDERUPTOLEVELMAXQTY	AS	ORD_LVL_MAX_QTY	,
SKUPLANNINGPARAM.ORDERUPTOLEVELMAXRULE	AS	ORD_LVL_MAX_RULE	,
SKUPLANNINGPARAM.OUTHANDLINGCOST	AS	SHIP_HDLNG_COST	,
case when SKUPLANNINGPARAM.PEGSW = '1' THEN 'Y' ELSE 'N' END AS SUPPLY_TO_DMD_PEG_FLAG,
---SKUPLANNINGPARAM.PEGSW	AS	SUPPLY_TO_DMD_PEG_FLAG	, --0,1
SKUPLANNINGPARAM.PLANDUR	AS	PLAN_DUR	,
SKUPLANNINGPARAM.PLANLEADTIME	AS	PLAN_LEADTIME_DY_CNT	,
SKUPLANNINGPARAM.PLANLEADTIMERULE	AS	PLAN_LEADTIME_RULE,
SKUPLANNINGPARAM.PLANSHIPFRZDUR	AS	PLAN_SHIP_FREEZE_DUR	,
SKUPLANNINGPARAM.PRODCAL AS PRODTN_CLNDR_ID,
---SKUPLANNINGPARAM.PRODCAL	AS	PRODTN_CLNDR_KEY	,
SKUPLANNINGPARAM.PRODSTARTDATE	AS	PRODTN_START_DTE	,
SKUPLANNINGPARAM.PRODSTOPDATE	AS	PRODTN_STOP_DTE	,
SKUPLANNINGPARAM.RECSCHEDRCPTSDUR	AS	RECOMMENDED_SCHED_RCPT_DUR	,
SKUPLANNINGPARAM.RESTRICTDUR	AS	RESTRCT_PLAN_DUR	,
SKUPLANNINGPARAM.SALEDELAYDUR	AS	SLS_DELAY_DUR	,
SKUPLANNINGPARAM.SHRINKAGEFACTOR	AS	SHRINKAGE_FACTOR_VAL	,
case when SKUPLANNINGPARAM.SKULOTSIZEENABLESW = '1' THEN 'Y' ELSE 'N' END AS SKU_LOT_SZ_ENABLE_FLAG,
---SKUPLANNINGPARAM.SKULOTSIZEENABLESW	AS	SKU_LOT_SZ_ENABLE_FLAG	, --1,0
---TRY_TO_DATE(IKPF.BLDAT,'YYYYMMDD')
SKUPLANNINGPARAM.SOURCEADJFIRSTREPLENDATE	AS	SRC_ADJ_FIRST_REPL_DTE	,
SKUPLANNINGPARAM.SUPPINVCAL AS SUPPLY_INVTY_CLNDR_ID,
---SKUPLANNINGPARAM.SUPPINVCAL	AS	SUPPLY_INVTY_CLNDR_KEY	,
SKUPLANNINGPARAM.SUPSDMINDMDCOVDUR	AS	MIN_DMD_DUR	,

case when SKUPLANNINGPARAM.USEWIPSW = '1' THEN 'Y' ELSE 'N' END AS WORK_IN_PROGRESS_FLAG,
--SKUPLANNINGPARAM.USEWIPSW	AS	WORK_IN_PROGRESS_FLAG	,   --1,0

SKUPLANNINGPARAM.WORKINGCAL AS WORKING_CLNDR_ID
----SKUPLANNINGPARAM.WORKINGCAL	AS	WORKING_CLNDR_KEY	
FROM {{source('JDA','SKUPLANNINGPARAM')}} SKUPLANNINGPARAM