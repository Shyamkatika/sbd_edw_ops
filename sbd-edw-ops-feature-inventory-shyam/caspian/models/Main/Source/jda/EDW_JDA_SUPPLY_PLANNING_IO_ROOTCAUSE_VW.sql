Select
UPPER(CONCAT(coalesce(UDTIOROOTCAUSE.U_ITEM::varchar,''),'~',coalesce(UDTIOROOTCAUSE.U_LOC::varchar,''),'~' ,coalesce(UDTIOROOTCAUSE.U_PLAN_DATE::varchar,''),'~' ,coalesce(UDTIOROOTCAUSE.U_TARGET_DATE::varchar,''))) AS SUPPLY_PLNG_IO_RC_KEY,
'JDA' AS {{var('column_srcsyskey')}},
MD5(UPPER(CONCAT(coalesce(UDTIOROOTCAUSE.U_ITEM::varchar,''),'~',coalesce(UDTIOROOTCAUSE.U_LOC::varchar,''),'~' ,coalesce(UDTIOROOTCAUSE.U_PLAN_DATE::varchar,''),'~' ,coalesce(UDTIOROOTCAUSE.U_TARGET_DATE::varchar,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
UDTIOROOTCAUSE.LOADDTS AS {{var('column_z3loddtm')}},
UDTIOROOTCAUSE.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
case when length(trim(UPPER(UDTIOROOTCAUSE.U_ITEM)))<1 then {{var('default_mapkey')}} when UPPER (UDTIOROOTCAUSE.U_ITEM) IS NULL then  {{var('default_mapkey')}} else UPPER (UDTIOROOTCAUSE.U_ITEM) end AS PROD_KEY,
case when length(trim(UPPER(UDTIOROOTCAUSE.U_LOC)))<1 then {{var('default_mapkey')}} when UPPER (UDTIOROOTCAUSE.U_LOC) IS NULL then  {{var('default_mapkey')}} else UPPER (UDTIOROOTCAUSE.U_LOC) end AS LOC_KEY,
UDTIOROOTCAUSE.U_PLAN_DATE AS PLN_DTE,
UDTIOROOTCAUSE.U_TARGET_DATE AS TGT_DTE,
UDTIOROOTCAUSE.U_SBU AS SBU,
UDTIOROOTCAUSE.U_REGION AS REGN_LKEY,
UDTIOROOTCAUSE.U_TOTAL_FORECAST AS TOT_FCST,
UDTIOROOTCAUSE.U_WMAPE AS WGTD_AVG_ABS_PCT_ERR,
UDTIOROOTCAUSE.U_SERVICE_LEVEL AS SVC_LVL,
UDTIOROOTCAUSE.U_EFFECTIVE_LEADTIME AS EFF_LEADTIME,
UDTIOROOTCAUSE.U_SERVICE_LEVEL_SOURCE AS SVC_LVL_SRC,
UDTIOROOTCAUSE.U_LTSD AS LEADTIME_STD_DEVN,
UDTIOROOTCAUSE.U_APPROVAL_STATUS AS APRV_STAT,
UDTIOROOTCAUSE.U_ROP AS REORD_PT,
UDTIOROOTCAUSE.U_NEW_SS_QTY AS NEW_SFTY_STK_QTY,
UDTIOROOTCAUSE.U_NEW_SS_VALUE AS NEW_SFTY_STK_VAL,
UDTIOROOTCAUSE.U_ACCEPTED_QTY AS ACCPTD_SFTY_STK_QTY,
UDTIOROOTCAUSE.U_ACCEPTED_VALUE AS ACCPTD_SFTY_STK_VAL,
UDTIOROOTCAUSE.U_LAST_APPROVED_SS_QTY AS LAST_APRV_SFTY_STK_QTY,
UDTIOROOTCAUSE.U_LAST_APPROVED_SS_VALUE AS LAST_APRV_SFTY_STK_VAL,
UDTIOROOTCAUSE.U_COV AS CVRG,
UDTIOROOTCAUSE.U_MINSS AS MIN_SFTY_STK,
UDTIOROOTCAUSE.U_SKU_CLASS AS SKU_CLASS,
UDTIOROOTCAUSE.U_SSTEMPLATE AS SFTY_SKT_TEMP,
UDTIOROOTCAUSE.U_SSCOV AS SFTY_STK_CVRG_DUR
FROM {{source('JDA','UDTIOROOTCAUSE')}} UDTIOROOTCAUSE