select
UPPER(CONCAT(coalesce(CURRENCYPROFILEVAL.FROMCURRENCY,''),'~',coalesce(CURRENCYPROFILEVAL.TOCURRENCY,''),'~' ,coalesce(CURRENCYPROFILEVAL.STARTDATE,''))) AS CRNCY_PRFL_KEY,
'JDA' AS {{var('column_srcsyskey')}},
MD5(UPPER(CONCAT(coalesce(CURRENCYPROFILEVAL.FROMCURRENCY,''),'~',coalesce(CURRENCYPROFILEVAL.TOCURRENCY,''),'~' ,coalesce(CURRENCYPROFILEVAL.STARTDATE,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
CURRENCYPROFILEVAL.LOADDTS AS {{var('column_z3loddtm')}},
CURRENCYPROFILEVAL.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
CURRENCYPROFILEVAL.STARTDATE AS CRNCY_PRFL_START_DTE,
CURRENCYPROFILEVAL.ENDDATE AS CRNCY_PRFL_END_DTE,
CURRENCYPROFILEVAL.FROMCURRENCY AS ORIG_FROM_CRNCY_TYP,
CURRENCYPROFILEVAL.TOCURRENCY AS TGT_TO_CRNCY_TYP,
CURRENCYPROFILEVAL.CONVERSIONVALUE AS CRNCY_CONV_RATE
FROM {{source('JDA','CURRENCYPROFILEVAL')}} CURRENCYPROFILEVAL