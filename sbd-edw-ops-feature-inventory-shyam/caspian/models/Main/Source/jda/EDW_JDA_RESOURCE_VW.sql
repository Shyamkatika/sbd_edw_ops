select 
UPPER(RES.RES) as RESOURCE_KEY,
'JDA' AS  {{var('column_srcsyskey')}},
MD5(UPPER(RES.RES)) AS  {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS  {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS  {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS  {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS  {{var('column_ETL_UPD_DTE')}},
RES.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS  {{var('column_verexpirydt')}},
{{var('default_y')}} as {{var('column_currrecflag')}},
{{var('default_n')}} as {{var('column_orprecflag')}},
RES.LOADDTS AS  {{var('column_z3loddtm')}},

RES.ADDONCOST AS ONE_UNIT_CAPACITY_COST,
RES.ADJFACTOR AS ADJ_FACTOR,
RES.AVGFAMILYCHG AS AVG_FAMILY_CHANGES_NBR,
RES.AVGFAMILYCHGCOST AS AVG_FAMILY_CHANGES_COST,
RES.AVGSKUCHG AS AVG_SKU_CHG_NBR,
RES.AVGSKUCHGCOST AS AVG_SKU_CHG_COST,
RES.BUCKETSW AS BUCKET_SPECIFIES_CAPACITY,
RES.CAL AS ASSCTD_RESOURCE_CLNDR,
case when RES.CAPSHORTREPORTSW=1 then 'Y' when RES.CAPSHORTREPORTSW=0 then 'N' else {{var('default_flag')}}  end AS CAPACITY_SHORT_RPT_FLAG,
RES.CHECKMAXCAP  AS CAPACITY_CNSTRNT_TYP,
RES.COST AS RESOURCE_PER_UNIT_CAPACITY_COST,
RES.CRITICALITEM AS CRTCL_ITEM,
RES.CURRENCYUOM AS UOM_CRNCY,
RES.DESCR AS RESOURCE_DESC,
case when RES.ENABLESW=1 then 'Y' when RES.ENABLESW=0 then 'N' else {{var('default_flag')}} end  AS RESOURCE_OPTIMIZER_FLAG,
RES.INCUNUSEDUR AS RESOURCE_INCREMENTAL_DUR,
case when RES.LEVELLOADSW=1 then 'Y' when RES.LEVELLOADSW=0 then 'N' else {{var('default_flag')}} end   AS LOD_LVL_FLAG,
RES.LEVELSEQNUM AS LVL_SEQ_NBR,
case when length(trim(RES.LOC)) <1 then {{var('default_mapkey')}} when RES.LOC IS NULL then {{var('default_mapkey')}} else replace(UPPER(RES.LOC),'"','') end as LOC_KEY,
case when RES.OVERTIMESW=1 then 'Y' when RES.OVERTIMESW=0 then 'N'else {{var('default_flag')}} end   AS RESOURCE_OVTM_CAPACITY_FLAG,
case when RES.PEGGINGSW=1 then 'Y' when RES.PEGGINGSW=0 then 'N' else {{var('default_flag')}} end   AS RESOURCE_PEGGING_RESLT_FLAG,
RES.PRODSMOOTHCAL AS PRODTN_SMOOTHING_CLNDR,
RES.PRODSMOOTHINITLOAD AS PRODTN_INIT_LOD,
RES.PRODUCTIONFAMILYCHGOVEROPT AS PRODTN_FAMILY_CHG_OVER_OPT,
RES.QTYUOM AS UOM_QTY,
RES.RELEASEFENCEDUR AS RELS_FENCE_DUR,
RES.RES AS RESOURCE_GRP,
RES.SHIFTSIZE AS SHFT_SZ,
RES.SOURCE AS RESOURCE_SRC_LOC_TYP,
RES.STAGE AS RESOURCE_STG_NAME,
RES.STORAGECLASS AS STORG_CAPACITY_CLS,
RES.STORAGEGROUP AS ITEM_STORG_GRP_NAME,
RES.TYPE AS RESOURCE_TYP,
RES.U_MAXCAP AS MAX_CAPACITY,
case when RES.U_PRIMARY=1 then 'Y' when RES.U_PRIMARY=0 then 'N' else {{var('default_flag')}} end  AS PRIM_RESOURCE_FLAG,
RES.SATRDUR AS SATR_DUR,
TRY_TO_NUMBER(RES.MINQUEUETIME) AS MIN_QUEUE_TM,
TRY_TO_NUMBER(RES.ESTMTDQUEUETIME) AS EST_QUEUE_TM,
RES.ENABLEOPT AS RCRD_ENABLE_OPT
FROM {{source('JDA','RES')}} RES