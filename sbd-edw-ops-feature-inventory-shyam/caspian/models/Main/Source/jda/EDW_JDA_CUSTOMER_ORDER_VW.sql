SELECT
UPPER(concat(COALESCE(CUSTORDER.ITEM,''),'~',COALESCE(CUSTORDER.LOC,''),'~',COALESCE(CUSTORDER.ORDERID,''),'~',COALESCE(CUSTORDER.SHIPDATE,''))) AS CUST_ORD_KEY,
'JDA' AS {{var('column_srcsyskey')}},
MD5(UPPER(concat(COALESCE(CUSTORDER.ITEM,''),'~',COALESCE(CUSTORDER.LOC,''),'~',COALESCE(CUSTORDER.ORDERID,''),'~',COALESCE(CUSTORDER.SHIPDATE,'')))) AS {{var('column_redhashkey')}},
{{var('default_n')}} AS {{var('column_delfromsrcflag')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
CUSTORDER.LOADDTS AS {{var('column_z3loddtm')}},
CUSTORDER.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
CUSTORDER.CALCPRIORITY AS FCST_ORD_PRYRT_NBR,
CUSTORDER.COST AS CUST_ORD_COST,
CUSTORDER.CUST AS CUST_ORD_TYP,
CUSTORDER.DELIVERYDATE as ORD_DUE_DTE,
case when length(trim(UPPER((CUSTORDER.DEST)))) <1 then {{var('default_mapkey')}} when UPPER(CUSTORDER.DEST)
IS NULL then {{var('default_mapkey')}}
 when UPPER(CUSTORDER.DEST) = 'NULL' then {{var('default_mapkey')}} else UPPER(CUSTORDER.DEST) end AS DEST_LOC_KEY,
case when length(trim(UPPER((CUSTORDER.DFULOC)))) <1 then {{var('default_mapkey')}} when UPPER(CUSTORDER.DFULOC)
IS NULL then {{var('default_mapkey')}} else UPPER(CUSTORDER.DFULOC) end AS DFU_LOC_KEY,
case when length(trim(UPPER((CUSTORDER.DMDGROUP)))) <1 then {{var('default_mapkey')}} when UPPER(CUSTORDER.DMDGROUP)
IS NULL then {{var('default_mapkey')}} else UPPER(CUSTORDER.DMDGROUP) end AS DMD_GRP_KEY,
CUSTORDER.DMDUNIT AS DMD_UNIT_NAME,
CASE WHEN CUSTORDER.FCSTSW = '1' THEN 'Y' ELSE 'N' END AS FCST_ORD_FLAG,
CUSTORDER.FCSTTYPE AS FCST_TYP,
CASE WHEN CUSTORDER.FIRMSW = '1' THEN 'Y' ELSE 'N' END AS ORD_FIRM_FLAG,
CUSTORDER.HEADEREXTREF AS CUST_ORD_LN_NBR,
case when length(trim(UPPER((CUSTORDER.ITEM)))) <1 then {{var('default_mapkey')}} when UPPER(CUSTORDER.ITEM)
IS NULL then {{var('default_mapkey')}} else UPPER(CUSTORDER.ITEM) end AS PROD_KEY,
CUSTORDER.LINEITEMEXTREF  AS CUST_ORD_IMPORTED_TYP,
case when length(trim(UPPER((CUSTORDER.LOC)))) <1 then {{var('default_mapkey')}} when UPPER(CUSTORDER.LOC)
IS NULL then {{var('default_mapkey')}} else UPPER(CUSTORDER.LOC) end AS LOC_KEY,
CUSTORDER.MARGIN AS PROD_PROFIT_AMT,
To_NUMBER(CUSTORDER.MAXEARLYDUR) AS CUST_EARLY_ORD_ACCPT_DY_CNT,
TO_NUMBER(CUSTORDER.MAXLATEDUR) AS CUST_LATE_ORD_ACCPT_DY_CNT,
CUSTORDER.MAXSHIPNUM AS MAX_SHIP_ACCEPTABLE_NBR,
CUSTORDER.MINSHIPQTY AS MIN_SHIP_QTY,
TO_DECIMAL(CUSTORDER.ONLYPROJECTSW,10) AS MATCH_PROJ_CD,
CUSTORDER.ORDERID AS PROD_ORD_NBR,
CUSTORDER.ORDERLINEITEM AS PROD_ORD_LN_NBR,
CUSTORDER.ORDERSEQNUM AS ORD_SEQ_NBR,
CASE WHEN CUSTORDER.OVERRIDEFCSTTYPESW = '1' THEN 'Y' ELSE 'N' END AS CUST_ORD_FCST_FLAG,
TO_DECIMAL(CUSTORDER.PRIORITY,10) AS CUST_ORD_PRYRT,
CUSTORDER.PRIORITYGROUP AS CUST_ORD_PRYRT_GRP,
CUSTORDER.PRIORITYSEQNUM AS CUST_ORD_SEQ_NBR,
CUSTORDER.PROJECT AS PROJ_ID_NBR,
CUSTORDER.PROJECTSHORTQTY AS PROJ_THRESHOLD_QTY,
CUSTORDER.PROMISEDDATE as PROD_DLV_DTE,
CUSTORDER.PROMISEDQTY AS PROD_PROMISED_QTY,
CUSTORDER.QTY AS SKU_SPEC_NBR,
CUSTORDER.RESEXP as PROD_EXPR_DTE,
CUSTORDER.REVENUE AS PROD_SELL_PRC,
CUSTORDER.SHIPDATE as SHIP_DTE,
CASE WHEN CUSTORDER.SHIPEARLYSW = '1' THEN 'Y' ELSE 'N' END  AS EARLY_SHIP_FLAG,
TO_DECIMAL(CUSTORDER.STATUS,10)  AS CURR_ON_HAND_INVTY_TYP,
CUSTORDER.SUBSTLEVEL AS SUBST_LVL,
CUSTORDER.SUBSTOPERATOR AS SUBST_OPERATOR,
CASE WHEN CUSTORDER.SUPERSEDESW = '1' THEN 'Y' ELSE 'N' END AS PROD_SUPERSEDED_FLAG,
TO_DECIMAL(CUSTORDER.TARGETEARLYDUR,10) as CUST_RQST_DLV_DUR,
CUSTORDER.UNITPRICE AS PROD_UNIT_PRC,
CUSTORDER.WORKSCOPE AS PRODTN_MTHD_NBR,
CASE WHEN CUSTORDER.ATPEXCLUDESW = '1' THEN 'Y' ELSE 'N' END AS ATP_EXCL_FLAG,
CUSTORDER.QUOTEMULTIPLE AS QUOTE_MULT,
CUSTORDER.U_CUSTREGION AS CUST_REGN,
CUSTORDER.U_RESTYPE AS RSRV_TYP,
CUSTORDER.ORDERTYPE AS ORD_TYP,
case when CUSTORDER.RESERVATION = '1' then 'Y' else 'N' END AS RSRV_CUST_ORD_FLAG
FROM {{source('JDA','CUSTORDER')}}  CUSTORDER