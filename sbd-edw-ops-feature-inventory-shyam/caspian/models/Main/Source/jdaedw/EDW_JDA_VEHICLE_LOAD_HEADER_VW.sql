select 
UPPER(VEHICLELOAD.LOADID) AS VHCL_LOD_HDR_KEY,
'JDAEDW' AS  {{var('column_srcsyskey')}},
MD5(UPPER(VEHICLELOAD.LOADID)) AS  {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS  {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS  {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS  {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS  {{var('column_ETL_UPD_DTE')}},
VEHICLELOAD.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS  {{var('column_verexpirydt')}},
{{var('default_y')}} as {{var('column_currrecflag')}},
{{var('default_n')}} as {{var('column_orprecflag')}},
VEHICLELOAD.LOADDTS AS  {{var('column_z3loddtm')}},

case when (VEHICLELOAD.APPROVALSTATUS)=1 then 'Y' when (VEHICLELOAD.APPROVALSTATUS)=0 then 'N' else {{var('default_flag')}} end AS LOD_APRV_FLAG,
VEHICLELOAD.ARRIVDATE AS LOD_ARRVL_DTE,
VEHICLELOAD.CONSOLIDATEDLOADSEQNUM AS CONSOLIDATED_LOD_SEQ_NBR,
VEHICLELOAD.LOADID AS VHCL_LOD_ID,
VEHICLELOAD.DESCR AS VHCL_LOD_DESC,
VEHICLELOAD.DESTSTATUS as VHCL_LOD_TRNSPRT_STAT,
case when (VEHICLELOAD.EXPORTED)=1 then 'Y' when (VEHICLELOAD.EXPORTED)=0 then 'N' else {{var('default_flag')}} end AS LOD_ALREADY_EXPORTED_FLAG,
VEHICLELOAD.GROUPORDERID as VHCL_LOD_GRP_ORD_ID,
VEHICLELOAD.LANEGROUPID as VHCL_LOD_LANE_GRP_ID,
case when (VEHICLELOAD.LANEGROUPMINMETSW)=1 then 'Y' when (VEHICLELOAD.LANEGROUPMINMETSW)=0 then 'N' else {{var('default_flag')}} end LANE_GRP_MET_MIN_FLAG,
VEHICLELOAD.LBSOURCE as VHCL_LOD_ORIG_STAT,
VEHICLELOAD.LBSTATUS AS LOD_BUILDING_STAT_NBR,
case when (VEHICLELOAD.LOADSW)=1 then 'Y' when (VEHICLELOAD.LOADSW)=0 then 'N' else {{var('default_flag')}}  end AS ADDTN_LOD_POSBL_FLAG,
case when (VEHICLELOAD.LSRULEMETSW)=1 then 'Y' when (VEHICLELOAD.LSRULEMETSW)=0 then 'N' else {{var('default_flag')}}  end AS LOD_SATISFACTION_RULE_MET_FLAG,
case when (VEHICLELOAD.MAXCAPACITYEXCEEDEDSW)=1 then 'Y' when (VEHICLELOAD.MAXCAPACITYEXCEEDEDSW)=0 then 'N' else {{var('default_flag')}} end AS MAX_CAPACITY_EXCEEDED_FLAG,
case when (VEHICLELOAD.MAXCAPACITYMETSW)=1 then 'Y' when (VEHICLELOAD.MAXCAPACITYMETSW)=0 then 'N' else {{var('default_flag')}} end AS MAX_CAPACITY_MET_FLAG,
VEHICLELOAD.ORDERID AS VHCL_LOD_ORD_NBR,
VEHICLELOAD.ORDEROPTSEQNUM AS VHCL_LOD_SEQ_NBR,
VEHICLELOAD.SHIPDATE AS LOD_DISPATCHED_DTE,
VEHICLELOAD.SOURCESTATUS as LOD_QTY_SHIP_STAT,
VEHICLELOAD.STATUSDESC as STAT_DESC,
VEHICLELOAD.STATUSDESCR as STAT_VAL,
case when (VEHICLELOAD.TOLERANCECAPMETSW)=1 then 'Y' when (VEHICLELOAD.TOLERANCECAPMETSW)=0 then 'N' else {{var('default_flag')}} end AS TLRNCE_CAPACITY_MET_FLAG,
VEHICLELOAD.TRANSMODE as TRNSPRT_MODE,
case when (VEHICLELOAD.TRANSMODEMINMETSW)=1 then 'Y' when (VEHICLELOAD.TRANSMODEMINMETSW)=0 then 'N' else {{var('default_flag')}} end AS TRNSPRT_MIN_MET_FLAG,
VEHICLELOAD.U_ERPARRIVDATE AS ERP_ARRVL_DTE,
VEHICLELOAD.U_ERPSHIPDATE AS ERP_SHIP_DTE,
VEHICLELOAD.U_GLOBAL_SOLVE AS GLB_SOLVE,
VEHICLELOAD.U_RECORD_TYPE as RCRD_TYP,
VEHICLELOAD.U_SOURCE_REF AS SRC_REF_NBR,
VEHICLELOAD.U_VENDOR AS VEND_NAME,
VEHICLELOAD.U_VENDORGLOBALCODE as VEND_GLB_CD,
VEHICLELOAD.U_VMIPO AS VMIPO,
case when (VEHICLELOAD.UPDATED)=1 then 'Y' when (VEHICLELOAD.UPDATED)=0 then 'N' else {{var('default_flag')}} end AS LOD_MGR_FLAG,
case when (VEHICLELOAD.VENDORMINMETSW)=1 then 'Y' when (VEHICLELOAD.VENDORMINMETSW)=0 then 'N' else {{var('default_flag')}} end AS VEND_MIN_MET_FLAG
FROM {{source('JDAEDW','VEHICLELOAD')}} VEHICLELOAD
