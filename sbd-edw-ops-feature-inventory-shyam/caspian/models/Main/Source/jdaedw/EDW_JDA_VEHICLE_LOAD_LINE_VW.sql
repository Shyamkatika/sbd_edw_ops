select 
UPPER(concat(coalesce(VEHICLELOADLINE.LOADID::VARCHAR,''),'~',coalesce(VEHICLELOADLINE.PRIMARYITEM::VARCHAR::VARCHAR,''),'~',coalesce(VEHICLELOADLINE.EXPDATE::VARCHAR,''),'~',coalesce(VEHICLELOADLINE.ITEM::VARCHAR,''),'~',coalesce(VEHICLELOADLINE.DEST::VARCHAR,''))) as VHCL_LOD_LN_KEY,
'JDAEDW' AS  {{var('column_srcsyskey')}},
MD5(UPPER(concat(coalesce(VEHICLELOADLINE.LOADID::VARCHAR,''),'~',coalesce(VEHICLELOADLINE.PRIMARYITEM::VARCHAR::VARCHAR,''),'~',coalesce(VEHICLELOADLINE.EXPDATE::VARCHAR,''),'~',coalesce(VEHICLELOADLINE.ITEM::VARCHAR,''),'~',coalesce(VEHICLELOADLINE.DEST::VARCHAR,'')))) AS  {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS  {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS  {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS  {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS  {{var('column_ETL_UPD_DTE')}},
VEHICLELOADLINE.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS  {{var('column_verexpirydt')}},
{{var('default_y')}} as {{var('column_currrecflag')}},
{{var('default_n')}} as {{var('column_orprecflag')}},
VEHICLELOADLINE.LOADDTS AS  {{var('column_z3loddtm')}},

VEHICLELOADLINE.ACTION as LOD_ACTN_PERFORM_TYP,
case when (VEHICLELOADLINE.ACTIONALLOWEDSW)=1 then 'Y' when (VEHICLELOADLINE.ACTIONALLOWEDSW)=0 then 'N' else {{var('default_flag')}} end as VHCL_LOD_SUGGESTED_ACTN_ALLOW_FLAG,
VEHICLELOADLINE.ACTIONDATE AS VHCL_LOD_SUGGESTED_SUPPLY_DTE,
VEHICLELOADLINE.ACTIONQTY AS VHCL_LOD_SUGGESTED_SUPPLY_QTY,
case when length(trim(VEHICLELOADLINE.DEST)) <1 then {{var('default_mapkey')}} when VEHICLELOADLINE.DEST IS NULL then {{var('default_mapkey')}} else (VEHICLELOADLINE.DEST) end as DEST_LOC_KEY,
VEHICLELOADLINE.DRAWQTY AS DRAW_QTY,
VEHICLELOADLINE.EARLIESTSELLDATE AS SELL_DTE,
VEHICLELOADLINE.EXPDATE AS SKU_EXPR_DTE,
VEHICLELOADLINE.GROUPORDERID VHCL_LOD_GRP_ORD_ID,
case when length(trim(VEHICLELOADLINE.ITEM)) <1 then {{var('default_mapkey')}} when VEHICLELOADLINE.ITEM IS NULL then {{var('default_mapkey')}} else (VEHICLELOADLINE.ITEM) end as PROD_KEY,
VEHICLELOADLINE.GROUPORDERID as VHCL_LOD_ORIG_STAT,
VEHICLELOADLINE.LOADID AS VHCL_LOD_ID,
VEHICLELOADLINE.LOADLINEID AS LOD_LN_NBR,
VEHICLELOADLINE.MUSTGOQTY MUST_GO_QTY,
VEHICLELOADLINE.ORDERID AS VHCL_LOD_ORD_NBR,
VEHICLELOADLINE.ORDERNUM AS VHCL_LOD_LN_ORD_NBR,
case when length(trim(VEHICLELOADLINE.PRIMARYITEM)) <1 then {{var('default_mapkey')}} when VEHICLELOADLINE.PRIMARYITEM IS NULL then {{var('default_mapkey')}} else (VEHICLELOADLINE.PRIMARYITEM) end as DMD_PROD_KEY,
VEHICLELOADLINE.PRIMARYITEMQTY AS DMD_PRIM_QTY,
VEHICLELOADLINE.PRIORITY AS LOD_PRYRT_NBR,
VEHICLELOADLINE.PROJECT AS VHCL_LOD_PROJ_NBR,
VEHICLELOADLINE.QTY AS PROD_QTY,
VEHICLELOADLINE.REVISEDDATE AS REVISED_DTE,
VEHICLELOADLINE.REVISEDEXPDATE AS REVISED_EXPR_DTE,
VEHICLELOADLINE.SCHEDARRIVDATE AS SCHED_ARRVL_DTE,
VEHICLELOADLINE.SCHEDSHIPDATE AS LOD_SCHED_SHIP_DTE,
VEHICLELOADLINE.SEQNUM AS LOD_LN_SEQ_NBR,
VEHICLELOADLINE.SOURCE as SRC_LOC,
VEHICLELOADLINE.SOURCING AS SRC_MTHD_NAME,
VEHICLELOADLINE.SUPPLYID AS  SUPPLY_ID,
VEHICLELOADLINE.SUPPLYMETHOD as SUPPLY_MTHD,
VEHICLELOADLINE.SUPPORDERQTY AS SUPL_ORD_QTY,
VEHICLELOADLINE.U_APPROVE::varchar as VHCL_LOD_PROD_STAT_APRV_NBR
FROM {{source('JDAEDW','VEHICLELOADLINE')}} VEHICLELOADLINE
