SELECT   
UPPER(CONCAT(COALESCE(PLANORDER.ITEM::VARCHAR,''),'~',COALESCE(PLANORDER.LOC::VARCHAR,''), '~', COALESCE(PLANORDER.SEQNUM::VARCHAR,''))) 
AS SUPPLY_PLND_ORD_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},
MD5(UPPER(CONCAT(COALESCE(PLANORDER.ITEM::VARCHAR,''),'~',COALESCE(PLANORDER.LOC::VARCHAR,''), '~', COALESCE(PLANORDER.SEQNUM::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
PLANORDER.LOADDTS as {{var('column_z3loddtm')}},
PLANORDER.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
PLANORDER.ACTION	AS	ACTN_TYP,
case when PLANORDER.ACTIONALLOWEDSW IS NULL then 'U' when UPPER(PLANORDER.ACTIONALLOWEDSW) in ('YES','TRUE','1') then 'Y'
when UPPER(PLANORDER.ACTIONALLOWEDSW) in ('NO','FALSE','0') then 'N' else 'U' end as ACTN_ALLOW_FLAG,
PLANORDER.ACTIONDATE	AS	RECOMMENDED_ACTN_DTE,
PLANORDER.ACTIONQTY	AS	ACTN_QTY,
PLANORDER.COPRODORDERTYPE	AS	CO_PROD_ORD_TYP,
PLANORDER.COPRODPRIMARYITEM	AS	CO_PROD_TYP,
PLANORDER.COVDURSCHEDDATE	AS	CVRG_DUR_SCHED_DTE,
case when PLANORDER.EDITSW IS NULL then 'U' when UPPER(PLANORDER.EDITSW) in ('YES','TRUE','1') then 'Y'
when UPPER(PLANORDER.EDITSW) in ('NO','FALSE','0') then 'N' else 'U' end as EDIT_PLND_ORD_FLAG,
PLANORDER.EXPDATE	AS	PLND_ORD_EXPIRY_DTE,
case when PLANORDER.FIRMPLANSW IS NULL then 'U' when UPPER(PLANORDER.FIRMPLANSW) in ('YES','TRUE','1') then 'Y'
when UPPER(PLANORDER.FIRMPLANSW) in ('NO','FALSE','0') then 'N' else 'U' end as FIRM_PLAN_FLAG,
PLANORDER.HEADERSEQNUM	AS	PLAN_ORD_HDR_SEQ_NBR,
PLANORDER.ITEM	AS	PROD_KEY,
PLANORDER.LOC	AS	LOC_KEY,
PLANORDER.NEEDDATE	AS	DMD_FULFIL_DTE,
PLANORDER.PRIMARYSEQNUM	AS	PRIM_SEQ_NBR,
PLANORDER.PRODUCTIONMETHOD	AS	PRODTN_MTHD_NAME,
PLANORDER.PROJECT	AS	PROJ_NBR,
--PLANORDER.QTY	AS	PLND_ORD_QTY,
to_number(PLANORDER.QTY,28,10)	AS	PLND_ORD_QTY,
PLANORDER.RECSCHEDRCPTSOPT	AS	SCHED_RCPT_OPT,
PLANORDER.REVISEDDATE	AS	PLAN_REVISED_DTE,
PLANORDER.REVISEDEXPDATE	AS	PLAN_REVISED_EXPR_DTE,
PLANORDER.SCHEDDATE	AS	PLND_ORD_MFG_DTE,
PLANORDER.SEQNUM	AS	PLAN_ORD_SEQ_NBR,
PLANORDER.STARTDATE	AS	PLND_ORD_START_DTE,
--PLANORDER.SUBSTQTY	AS	ALT_PROD_PLAN_ORD_QTY
to_number(PLANORDER.SUBSTQTY,28,10)	AS	ALT_PROD_PLAN_ORD_QTY
FROM {{source('BLUEYONDER','PLANORDER')}} PLANORDER