SELECT     
UPPER(CONCAT(COALESCE(CUSTORDER.ITEM::VARCHAR,''),'~',COALESCE(CUSTORDER.LOC::VARCHAR,''), '~', COALESCE(CUSTORDER.ORDERID::VARCHAR,''),
'~', COALESCE(CUSTORDER.SHIPDATE::VARCHAR,''))) AS CUST_ORD_KEY,
'BLUEYONDER' AS  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(CUSTORDER.ITEM::VARCHAR,''),'~',COALESCE(CUSTORDER.LOC::VARCHAR,''), '~', COALESCE(CUSTORDER.ORDERID::VARCHAR,''),
'~', COALESCE(CUSTORDER.SHIPDATE::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
CUSTORDER.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
CUSTORDER.LOADDTS AS {{var('column_z3loddtm')}},
CUSTORDER.CALCPRIORITY AS FCST_ORD_PRYRT_NBR,
to_number(CUSTORDER.COST,28,10) AS CUST_ORD_COST,
CUSTORDER.CUST AS CUST_ORD_TYP,
CUSTORDER.DFULOC AS DFU_LOC_KEY,
CUSTORDER.DMDGROUP AS DMD_GRP_KEY,
CUSTORDER.DMDUNIT AS DMD_UNIT_NAME,
case when CUSTORDER.FCSTSW IS NULL then 'U' when UPPER(CUSTORDER.FCSTSW) in ('YES','TRUE','1') then 'Y'
when UPPER(CUSTORDER.FCSTSW) in ('NO','FALSE','0') then 'N' else 'U' end as FCST_ORD_FLAG,
CUSTORDER.FCSTTYPE AS FCST_TYP,
case when CUSTORDER.FIRMSW IS NULL then 'U' when UPPER(CUSTORDER.FIRMSW) in ('YES','TRUE','1') then 'Y'
when UPPER(CUSTORDER.FIRMSW) in ('NO','FALSE','0') then 'N' else 'U' end as ORD_FIRM_FLAG,
CUSTORDER.HEADEREXTREF AS CUST_ORD_LN_NBR,
CUSTORDER.ITEM AS PROD_KEY,
CUSTORDER.LINEITEMEXTREF AS CUST_ORD_IMPORTED_TYP,
CUSTORDER.LOC AS LOC_KEY,
to_number(CUSTORDER.MARGIN ,28,10) AS PROD_PROFIT_AMT,
CUSTORDER.MAXEARLYDUR AS CUST_EARLY_ORD_ACCPT_DY_CNT,
CUSTORDER.MAXLATEDUR AS CUST_LATE_ORD_ACCPT_DY_CNT,
CUSTORDER.ONLYPROJECTSW AS MATCH_PROJ_CD,
CUSTORDER.ORDERID AS PROD_ORD_NBR,
CUSTORDER.ORDERLINEITEM AS PROD_ORD_LN_NBR,
case when CUSTORDER.OVERRIDEFCSTTYPESW IS NULL then 'U' when UPPER(CUSTORDER.OVERRIDEFCSTTYPESW) in ('YES','TRUE','1') then 'Y'
when UPPER(CUSTORDER.OVERRIDEFCSTTYPESW) in ('NO','FALSE','0') then 'N' else 'U' end as CUST_ORD_FCST_FLAG,
CAST(CUSTORDER.PRIORITY AS INT) AS CUST_ORD_PRYRT,
CUSTORDER.PRIORITYGROUP AS CUST_ORD_PRYRT_GRP,
CUSTORDER.PRIORITYSEQNUM AS CUST_ORD_SEQ_NBR,
CUSTORDER.PROJECT AS PROJ_ID_NBR,
--ROUND(CUSTORDER.PROJECTSHORTQTY) AS PROJ_THRESHOLD_QTY,
to_number(CUSTORDER.PROJECTSHORTQTY,28,10) AS PROJ_THRESHOLD_QTY,
CUSTORDER.PROMISEDDATE AS PROD_DLV_DTE,
--ROUND(CUSTORDER.PROMISEDQTY) AS PROD_PROMISED_QTY,
to_number(CUSTORDER.PROMISEDQTY,28,10) AS PROD_PROMISED_QTY,
CUSTORDER.QTY AS SKU_SPEC_NBR,
CUSTORDER.RESEXP AS PROD_EXPR_DTE,
--ROUND(CUSTORDER.REVENUE) AS PROD_SELL_PRC,
to_number(CUSTORDER.REVENUE ,28,10) AS PROD_SELL_PRC,
CUSTORDER.SHIPDATE AS SHIP_DTE,
CAST(CUSTORDER.STATUS AS INT) AS CURR_ON_HAND_INVTY_TYP,
CUSTORDER.SUBSTLEVEL AS SUBST_LVL,
CUSTORDER.SUBSTOPERATOR AS SUBST_OPERATOR,
case when CUSTORDER.SUPERSEDESW IS NULL then 'U' when UPPER(CUSTORDER.SUPERSEDESW) in ('YES','TRUE','1') then 'Y'
when UPPER(CUSTORDER.SUPERSEDESW) in ('NO','FALSE','0') then 'N' else 'U' end as PROD_SUPERSEDED_FLAG,
--ROUND(CUSTORDER.UNITPRICE) AS PROD_UNIT_PRC,
to_number(CUSTORDER.UNITPRICE ,28,10) AS PROD_UNIT_PRC,
CUSTORDER.WORKSCOPE AS PRODTN_MTHD_NBR,
case when CUSTORDER.ATPEXCLUDESW IS NULL then 'U' when UPPER(CUSTORDER.ATPEXCLUDESW) in ('YES','TRUE','1') then 'Y'
when UPPER(CUSTORDER.ATPEXCLUDESW) in ('NO','FALSE','0') then 'N' else 'U' end as ATP_EXCL_FLAG,
CUSTORDER.ORDERTYPE AS ORD_TYP,
case when CUSTORDER.RESERVATION IS NULL then 'U' when UPPER(CUSTORDER.RESERVATION) in ('YES','TRUE','1') then 'Y'
when UPPER(CUSTORDER.RESERVATION) in ('NO','FALSE','0.0000000000') then 'N' else 'U' end as RSRV_CUST_ORD_FLAG,
CUSTORDER.U_DIVISION AS DIV_KEY
FROM {{source('BLUEYONDER','CUSTORDER')}} CUSTORDER
