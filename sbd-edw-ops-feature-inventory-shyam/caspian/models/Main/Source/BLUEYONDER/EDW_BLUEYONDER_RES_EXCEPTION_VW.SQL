SELECT
UPPER(CONCAT(COALESCE(trim(RESEXCEPTION.FUNCTIONNUM),''),'~',COALESCE(trim(RESEXCEPTION.PROCESSID),'')
,'~',COALESCE(trim(RESEXCEPTION.SEQNUM),''),'~',COALESCE(trim(RESEXCEPTION.BATCHNUM),''))) AS RES_EXCEPTION_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(trim(RESEXCEPTION.FUNCTIONNUM),''),'~',COALESCE(trim(RESEXCEPTION.PROCESSID),'')
,'~',COALESCE(trim(RESEXCEPTION.SEQNUM),''),'~',COALESCE(trim(RESEXCEPTION.BATCHNUM),'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
RESEXCEPTION.LOADDTS as {{var('column_z3loddtm')}},
RESEXCEPTION.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
RESEXCEPTION.ITEM	AS	PROD_KEY,
RESEXCEPTION.LOC	AS	LOC_KEY,
RESEXCEPTION.RES	AS	RES,
RESEXCEPTION.EXCEPTION	AS	EXCEPTION,
RESEXCEPTION.DESCR	AS	DESCR,
RESEXCEPTION.EXCEPTIONDATE	AS	EXCEPTIONDATE,
RESEXCEPTION.WHEN	AS	WHEN,
RESEXCEPTION.CATEGORY	AS	CATEGORY,
RESEXCEPTION.SEVERITY	AS	SEVERITY,
RESEXCEPTION.PRODUCTIONMETHOD	AS	PRODUCTIONMETHOD,
RESEXCEPTION.STEPNUM	AS	STEPNUM,
RESEXCEPTION.FUNCTIONNAME	AS	FUNCTIONNAME,
RESEXCEPTION.FUNCTIONNUM	AS	FUNCTIONNUM,
RESEXCEPTION.PROCESSID	AS	PROCESSID,
RESEXCEPTION.SEQNUM	AS	SEQNUM,
RESEXCEPTION.BATCHNUM	AS	BATCHNUM
FROM {{source('BLUEYONDER','RESEXCEPTION')}} RESEXCEPTION