SELECT
UPPER(CONCAT(COALESCE(DFUTOSKU.ITEM::VARCHAR,''),'~',COALESCE(DFUTOSKU.SKULOC::VARCHAR,''),'~',COALESCE(DFUTOSKU.DMDUNIT::VARCHAR,''),'~',COALESCE(DFUTOSKU.DMDGROUP::VARCHAR,'')
,'~',COALESCE(DFUTOSKU.DFULOC::VARCHAR,''),'~',COALESCE(DFUTOSKU.EFF::VARCHAR,''),'~',COALESCE(DFUTOSKU.DISC::VARCHAR,''))) AS DFU_SKU_ASSOC_KEY,
'BLUEYONDER' AS  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(DFUTOSKU.ITEM::VARCHAR,''),'~',COALESCE(DFUTOSKU.SKULOC::VARCHAR,''),'~',COALESCE(DFUTOSKU.DMDUNIT::VARCHAR,''),'~',COALESCE(DFUTOSKU.DMDGROUP::VARCHAR,'')
,'~',COALESCE(DFUTOSKU.DFULOC::VARCHAR,''),'~',COALESCE(DFUTOSKU.EFF::VARCHAR,''),'~',COALESCE(DFUTOSKU.DISC::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
DFUTOSKU.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
DFUTOSKU.LOADDTS AS {{var('column_z3loddtm')}},
DFUTOSKU.CONVFACTOR AS PLAN_TO_FCST_CONV_FACTOR,
DFUTOSKU.DFULOC AS DFU_LOC_KEY,
DFUTOSKU.DMDGROUP AS DMD_GRP_KEY,
DFUTOSKU.DMDUNIT AS DMD_UNIT_KEY,
DFUTOSKU.EFF AS MAP_EFF_DTE,
DFUTOSKU.DISC AS MAP_EXPR_DTE,
DFUTOSKU.FCSTTYPE AS FCST_TYP,
DFUTOSKU.HISTTYPE AS HIST_TYP,
DFUTOSKU.ITEM AS PROD_KEY,
DFUTOSKU.MODEL AS MODEL_ALGORITHM_NAME,
DFUTOSKU.SKULOC AS LOC_KEY,
case when DFUTOSKU.SUPERSEDESW IS NULL then 'U' when UPPER(DFUTOSKU.SUPERSEDESW) in ('YES','TRUE','1') then 'Y'
when UPPER(DFUTOSKU.SUPERSEDESW) in ('NO','FALSE','0') then 'N' else 'U' end as DFU_SUPERSEDE_FLAG,
DFUTOSKU.ALLOCFACTOR AS ALLOC_FACTOR
FROM {{source('BLUEYONDER','DFUTOSKU')}} DFUTOSKU