SELECT     
UPPER(CONCAT(COALESCE(DFUEXCEPTION.DMDUNIT::VARCHAR,''),'~',COALESCE(DFUEXCEPTION.DMDGROUP::VARCHAR,''), '~', COALESCE(DFUEXCEPTION.LOC::VARCHAR,''),'~',
COALESCE(DFUEXCEPTION.MODEL::VARCHAR,''),'~', COALESCE(DFUEXCEPTION.FUNCTIONNAME::VARCHAR,''),'~', COALESCE(DFUEXCEPTION.EXCEPTION::VARCHAR,''),'~',
COALESCE(DFUEXCEPTION.FUNCTIONNUM::VARCHAR,''))) AS DMD_FCST_EXCEPTION_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(DFUEXCEPTION.DMDUNIT::VARCHAR,''),'~',COALESCE(DFUEXCEPTION.DMDGROUP::VARCHAR,''),'~', COALESCE(DFUEXCEPTION.LOC::VARCHAR,''),'~',
COALESCE(DFUEXCEPTION.MODEL::VARCHAR,''),'~', COALESCE(DFUEXCEPTION.FUNCTIONNAME::VARCHAR,''),'~', COALESCE(DFUEXCEPTION.EXCEPTION::VARCHAR,''),'~',
COALESCE(DFUEXCEPTION.FUNCTIONNUM::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
DFUEXCEPTION.LOADDTS as {{var('column_z3loddtm')}},
DFUEXCEPTION.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
DFUEXCEPTION.USERID	AS	PROC_EXECUTED_USER,
DFUEXCEPTION.WHEN	AS	EXCEPTION_DETECTION_DTE,
DFUEXCEPTION.DESCR	AS	EXCEPTION_DESC,
DFUEXCEPTION.FUNCTIONNAME	AS	EXCEPTION_NAME,
DFUEXCEPTION.FUNCTIONNUM	AS	EXCEPTION_TYP,
DFUEXCEPTION.MODEL	AS	MODEL_NAME,
DFUEXCEPTION.EXCEPTION	AS	EXCEPTION_CD_NBR,
DFUEXCEPTION.DMDUNIT	AS	DMD_FCST_UNIT_KEY,
DFUEXCEPTION.DMDGROUP	AS	DMD_GRP,
DFUEXCEPTION.LOC	AS	LOC_KEY
FROM {{source('BLUEYONDER','DFUEXCEPTION')}} DFUEXCEPTION
