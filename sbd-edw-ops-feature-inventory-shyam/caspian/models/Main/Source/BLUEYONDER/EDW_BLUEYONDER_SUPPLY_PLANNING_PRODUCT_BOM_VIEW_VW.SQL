SELECT     
UPPER(CONCAT(COALESCE(BOM.ITEM::VARCHAR,''),'~',COALESCE(BOM.SUBORD::VARCHAR,''),'~', COALESCE(BOM.LOC::VARCHAR,''),'~',
COALESCE(BOM.BOMNUM::VARCHAR,''),'~', COALESCE(BOM.EFF::VARCHAR,''),'~', COALESCE(BOM.OFFSET::VARCHAR,''))) AS SUPPLY_PLNG_PROD_BOM_VW_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(BOM.ITEM::VARCHAR,''),'~',COALESCE(BOM.SUBORD::VARCHAR,''),'~', COALESCE(BOM.LOC::VARCHAR,''),'~',
COALESCE(BOM.BOMNUM::VARCHAR,''),'~', COALESCE(BOM.EFF::VARCHAR,''),'~', COALESCE(BOM.OFFSET::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
BOM.LOADDTS as {{var('column_z3loddtm')}},
BOM.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
BOM.BOMNUM	AS	PROD_BOM_NBR,
BOM.CONSUMSTEPNUM	AS	PRODTN_STEP_NBR,
BOM.DISC	AS	BOM_CMPNT_DSCTU_DTE,
BOM.DRAWQTY	AS	PRNT_SKU_SUBORDINATE_QTY,
BOM.DRAWTYPE	AS	BOM_DRAWN_TYP,
BOM.ECN	AS	ENGNR_CHG_NTFCN,
BOM.EFF	AS	BOM_CMPNT_EFF_DTE,
BOM.ENABLEOPT	AS	ENABLE_OPT_NBR,
BOM.ITEM	AS	PRNT_BOM_PROD_KEY,
BOM.LOC	AS	PRNT_BOM_LOC_KEY,
BOM.MIXFACTOR	AS	PROD_VER_FACTOR,
BOM.OFFSET	AS	BOM_CMPNT_AVAILAIBLITY,
BOM.QTYPERASSEMBLY	AS	SKU_ASSEMBLY_QTY,
BOM.QTYUOM	AS	UOM_QTY,
BOM.SHRINKAGEFACTOR	AS	SHRINKAGE_FACTOR,
BOM.SPLITFACTOR	AS	SPLIT_FACTOR,
BOM.SUBORD	AS	CMPNT_BOM_PROD_KEY,
BOM.SUBORDLOC	AS	CMPNT_BOM_LOC_KEY,
case when BOM.SUPERSEDESW IS NULL then 'U' when UPPER(BOM.SUPERSEDESW) in ('YES','TRUE','1') then 'Y'
when UPPER(BOM.SUPERSEDESW) in ('NO','FALSE','0') then 'N' else 'U' end as CMPNT_BOM_SUPERSEDE_FLAG,
BOM.UNITCONVFACTOR	AS	UNIT_CONV_FACTOR,
BOM.YIELDFACTOR	AS	YIELD_FACTOR
FROM {{source('BLUEYONDER','BOM')}} BOM