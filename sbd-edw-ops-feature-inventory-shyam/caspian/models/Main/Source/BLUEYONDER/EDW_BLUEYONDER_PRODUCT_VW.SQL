with ITEM as (
  select 
  UPPER(COALESCE(ITEM::VARCHAR,'')) AS PROD_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER(COALESCE(ITEM::VARCHAR,''))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
LOADDTS as {{var('column_z3loddtm')}},
LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
I.DESCR as SUPPLY_UNIT_DESC,
I.DYNDEPQTY as DYN_DPLY_QTY,
I.PERISHABLESW as PROD_PERISHABLE_FLAG,
I.PRIORITY as PROD_DMD_PRYRT_NBR,
I.U_DELETE as DEL_FLAG,
NULL as GLB_ABC,
I.U_PLANNER as GLB_PLNR,
I.UNITPRICE as PROD_UNIT_PRC,
I.UOM as SUPPLY_UOM_DESC,
I.WGT as WGT,
I.VOL as VOL,
I.ALLOCPOLICY as PROD_ALLOC_POLICY,
I.CALCCUMLEADTIMESW as CUM_LEADTIME_DUR_CALC,
I.DDSKUSW as DYN_DPLY_SKU_VAL,
I.DDSRCCOSTSW as DYN_DPLY_SRC_COST,
I.DEFAULTUOM as UOM_ID,
I.DYNDEPDECIMALS as DYN_DPLY_DECIMAL_PLACE,
I.DYNDEPOPTION as DYN_DPLY_OPT,
I.DYNDEPPUSHOPT as DYN_DPLY_PUSH_PULL_INDCTR,
I.ITEMCLASS as ITEM_CLS,
I.PLANLEVEL as ITEM_PLAN_LVL,
I.RESTRICTPLANMODE as RESTRCT_PLAN_MODE,
I.SUPSNGROUPNUM as SUPERSESSION_GRP_NBR,
I.UNITSPERPALLET as PROD_PAL_UNIT_NBR,
NULL as DMD_UNIT_NAME,
NULL as DMD_UNIT_DESC,
NULL as DMD_UNIT_CREATE_DTE,
I.U_PRIMARY_PROD_FACILITY as MFG_LOC,
NULL as DMD_UOM_DESC,
I.U_COMMENTS as CMT_DESC,
I.U_COMMENTS_2 as USER_TEXT,
I.U_FCSTGRP as FCST_GRP,
I.U_GROUP as PROD_GRP_LKEY,
I.U_CATEGORY as PROD_CTGY_LKEY,
I.U_CATEGORY as GENERAL_ITEM_CTGY_LKEY,
I.U_FAMILY as PROD_FAMILY_NAME,
I.U_SERIES as PROD_LN_LKEY,
I.U_BRANDCD as BRAND_LKEY,
I.U_ITEM_TYPE as PROD_TYP_LKEY,
I.U_SEASON as SESNLTY_TEXT,
I.U_SQFT as DIM_TEXT,

   case when I.U_ACTIVE   IS NULL then 'U'
when UPPER(I.U_ACTIVE  ) in ('YES','TRUE','1') then 'Y'
when UPPER(I.U_ACTIVE  ) in ('NO','FALSE','0') then 'N' else 'U' 
end as PROD_STAT_TYP,
NULL as DMD_UNT_STAT,
I.U_EFFECTIVE as EFTV_DTE,
I.U_ITEM_CLASS as CSTM_ITEM_CLS,
I.U_PLANNING_ID as PLAN_NBR,
NULL as DMD_UNT_LVL,
NULL as PLNG_ITEM_NAME,
I.U_BRAND as BRAND_TEXT,
I.U_NEW_ITEM as DMDUNIT_CREATE_FLAG,
I.U_ATTR_ASGND as ATTR_ASGN_FLAG,
I.CUSTOMER as PRIM_CUST,
I.U_PLATFORM as PROD_PLTFRM,
I.U_SOPGROUP as SOP_GRP_LKEY,
I.U_MODEL_YEAR as MODL_YR,
I.U_CUT_WIDTH as CUT_WDTH,
I.U_DECK_MATERIAL as DECK_MATL,
I.U_DECK_SIZE as DECK_SZ,
I.U_DISCHARGE as DSCHG_LKEY,
I.U_FRONT_WHEEL_SIZE as FRNT_WHL_SZ,
I.U_REAR_WHEEL_SIZE as REAR_WHL_SZ,
I.U_STYLING as STYLE,
I.U_TRANSMISSION as TRNMSN_LKEY,
I.U_WPDHIERARCHYLEVEL1 as WPD_HIER_LVL_1,
I.U_WPDHIERARCHYLEVEL2 as WPD_HIER_LVL_2,
I.U_WPDHIERARCHYLEVEL3 as WPD_HIER_LVL_3,
I.U_REUSABLE_PKG as REUSBL_PKG_FLAG,
I.U_PLANNINGBOM as PLNG_BOM,
I.U_DECK_LIFT as DECK_LIFT,
I.U_DECK_WASH as DECK_WASH,
I.U_ENGINE_BRAND as ENGN_BRAND,
I.U_ENGINE_COOLING as ENGN_COOLN,
I.U_ENGINE_CYLINDERS as ENGN_CYLNDR,
I.U_ENGINE_DISPLACEMENT as ENGN_DSPLCE,
I.U_ENGINE_NUMBER as ENGN_NBR,
I.U_FRONT_TREAD as FRNT_TRD,
I.U_FUEL_SYSTEM as FUEL_SYS,
I.U_FUEL_TANK as FUEL_TANK,
I.U_HORSEPOWER as HP,
I.U_ITEM_ACCOUNTING_CLASS_CODE as ITEM_ACC_CLS_CD,
I.U_LOAD_CAPACITY as LOD_CPCTY,
I.U_MONITOR as MNTR,
I.U_POWER_SOURCE as PWR_SRC,
I.U_PTO as PTO,
I.U_REAR_TREAD as REAR_TRD,
I.U_RMC as RMC,
I.U_SEAT as SEAT,
I.U_SPEED as SPEED,
I.U_STARTER as STARTR,
I.U_SHAREDITEM as SHARED_ITEM
  FROM {{source('BLUEYONDER', 'ITEM')}} I
 where ASCII(ITEM)<>32 or LEN(TRIM(ITEM))<>0
),

DMD as (
  select 
  UPPER(COALESCE(DMDUNIT::VARCHAR,'')) AS PROD_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER(COALESCE(DMDUNIT::VARCHAR,''))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
LOADDTS as {{var('column_z3loddtm')}},
LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
NULL as SUPPLY_UNIT_DESC,
NULL as DYN_DPLY_QTY,
NULL as PROD_PERISHABLE_FLAG,
NULL as PROD_DMD_PRYRT_NBR,
D.U_DELETE as DEL_FLAG,
D.U_ABC_CD as GLB_ABC,
NULL as GLB_PLNR,
NULL as PROD_UNIT_PRC,
NULL as SUPPLY_UOM_DESC,
NULL as WGT,
NULL as VOL,
NULL as PROD_ALLOC_POLICY,
NULL as CUM_LEADTIME_DUR_CALC,
NULL as DYN_DPLY_SKU_VAL,
NULL as DYN_DPLY_SRC_COST,
NULL as UOM_ID,
NULL as DYN_DPLY_DECIMAL_PLACE,
NULL as DYN_DPLY_OPT,
NULL as DYN_DPLY_PUSH_PULL_INDCTR,
NULL as ITEM_CLS,
NULL as ITEM_PLAN_LVL,
NULL as RESTRCT_PLAN_MODE,
NULL as SUPERSESSION_GRP_NBR,
NULL as PROD_PAL_UNIT_NBR,
TRIM(D.DMDUNIT) as DMD_UNIT_NAME,
D.DESCR as DMD_UNIT_DESC,
D.U_NEW_DMD_UNT_DTE as DMD_UNIT_CREATE_DTE,
D.U_PRIMARY_PROD_FACILITY as MFG_LOC,
D.UOM as DMD_UOM_DESC,
NULL as CMT_DESC,
NULL as USER_TEXT,
D.U_FCSTGRP as FCST_GRP,
NULL as PROD_GRP_LKEY,
D.U_CATEGORY as PROD_CTGY_LKEY,
D.U_CATEGORY  as GENERAL_ITEM_CTGY_LKEY,
D.U_FAMILY as PROD_FAMILY_NAME,
D.U_SERIES as PROD_LN_LKEY,
D.U_BRANDCD as BRAND_LKEY,
NULL as PROD_TYP_LKEY,
NULL as SESNLTY_TEXT,
NULL as DIM_TEXT,
NULL  as PROD_STAT_TYP,
D.U_DMD_UNT_STS as DMD_UNT_STAT,
NULL as EFTV_DTE,
NULL as CSTM_ITEM_CLS,
NULL as PLAN_NBR,
D.U_DMD_UNT_LVL as DMD_UNT_LVL,
D.U_PLANNER as PLNG_ITEM_NAME,
D.U_BRAND as BRAND_TEXT,
NULL as DMDUNIT_CREATE_FLAG,
NULL as ATTR_ASGN_FLAG,
D.CUSTOMER as PRIM_CUST,
D.U_PLATFORM as PROD_PLTFRM,
NULL as SOP_GRP_LKEY,
NULL as MODL_YR,
NULL as CUT_WDTH,
NULL as DECK_MATL,
NULL as DECK_SZ,
NULL as DSCHG_LKEY,
NULL as FRNT_WHL_SZ,
NULL as REAR_WHL_SZ,
NULL as STYLE,
NULL as TRNMSN_LKEY,
NULL as WPD_HIER_LVL_1,
NULL as WPD_HIER_LVL_2,
NULL as WPD_HIER_LVL_3,
NULL as REUSBL_PKG_FLAG,
NULL as PLNG_BOM,
NULL as DECK_LIFT,
NULL as DECK_WASH,
NULL as ENGN_BRAND,
NULL as ENGN_COOLN,
NULL as ENGN_CYLNDR,
NULL as ENGN_DSPLCE,
NULL as ENGN_NBR,
NULL as FRNT_TRD,
NULL as FUEL_SYS,
NULL as FUEL_TANK,
NULL as HP,
NULL as ITEM_ACC_CLS_CD,
NULL as LOD_CPCTY,
NULL as MNTR,
NULL as PWR_SRC,
NULL as PTO,
NULL as REAR_TRD,
NULL as RMC,
NULL as SEAT,
NULL as SPEED,
NULL as STARTR,
NULL as SHARED_ITEM

FROM {{source('BLUEYONDER', 'DMDUNIT')}} D
where ASCII(DMDUNIT)<>32 or LEN(TRIM(DMDUNIT))<>0
),


UNQ as (
select I.PROD_KEY as PROD_KEY,
I.SRC_SYS_KEY,
I.RCRD_HASH_KEY,
I.DEL_FROM_SRC_FLAG,
I.ETL_INS_PID,
I.ETL_INS_DTE,
I.ETL_UPD_PID,
I.ETL_UPD_DTE,
I.ZONE3_LOD_DTE,
I.EFF_DTE,
I.EXPR_DTE,
I.CURR_RCRD_FLAG,
I.ORP_RCRD_FLAG,
-- 'BLUEYONDER' as  {{var('column_srcsyskey')}},  
-- MD5(UPPER(COALESCE(PROD_KEY::VARCHAR,''))) AS {{var('column_rechashkey')}},
-- {{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
-- '{{model.name}}' as {{var('column_ETL_INS_PID')}},
-- CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
-- '{{model.name}}' as {{var('column_ETL_UPD_PID')}},
-- CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
-- LOADDTS as {{var('column_z3loddtm')}},
-- LOADDTS as  {{var('column_vereffdte')}},
-- '9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
-- {{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
-- {{var('default_n')}} AS  {{var('column_orprecflag')}},
I.SUPPLY_UNIT_DESC as SUPPLY_UNIT_DESC,
I.DYN_DPLY_QTY as DYN_DPLY_QTY,
case when I.PROD_PERISHABLE_FLAG   IS NULL then 'U'
when UPPER(I.PROD_PERISHABLE_FLAG  ) in ('YES','TRUE','1') then 'Y'
when UPPER(I.PROD_PERISHABLE_FLAG  ) in ('NO','FALSE','0') then 'N' else 'U' 
end as PROD_PERISHABLE_FLAG,
I.PROD_DMD_PRYRT_NBR as PROD_DMD_PRYRT_NBR,
I.DEL_FLAG as DEL_FLAG,
D.GLB_ABC as GLB_ABC,
I.GLB_PLNR as GLB_PLNR,
I.PROD_UNIT_PRC as PROD_UNIT_PRC,
I.SUPPLY_UOM_DESC as SUPPLY_UOM_DESC,
I.WGT as WGT,
I.VOL as VOL,
I.PROD_ALLOC_POLICY as PROD_ALLOC_POLICY,
I.CUM_LEADTIME_DUR_CALC as CUM_LEADTIME_DUR_CALC,
I.DYN_DPLY_SKU_VAL as DYN_DPLY_SKU_VAL,
I.DYN_DPLY_SRC_COST as DYN_DPLY_SRC_COST,
I.UOM_ID as UOM_ID,
I.DYN_DPLY_DECIMAL_PLACE as DYN_DPLY_DECIMAL_PLACE,
I.DYN_DPLY_OPT as DYN_DPLY_OPT,
I.DYN_DPLY_PUSH_PULL_INDCTR as DYN_DPLY_PUSH_PULL_INDCTR,
I.ITEM_CLS as ITEM_CLS,
I.ITEM_PLAN_LVL as ITEM_PLAN_LVL,
I.RESTRCT_PLAN_MODE as RESTRCT_PLAN_MODE,
I.SUPERSESSION_GRP_NBR as SUPERSESSION_GRP_NBR,
I.PROD_PAL_UNIT_NBR as PROD_PAL_UNIT_NBR,
D.DMD_UNIT_NAME as DMD_UNIT_NAME,
D.DMD_UNIT_DESC as DMD_UNIT_DESC,
D.DMD_UNIT_CREATE_DTE as DMD_UNIT_CREATE_DTE,
NVL(I.MFG_LOC, D.MFG_LOC) as MFG_LOC,
D.DMD_UOM_DESC as DMD_UOM_DESC,
I.CMT_DESC as CMT_DESC,
I.USER_TEXT as USER_TEXT,
NVL(I.FCST_GRP,D.FCST_GRP)  as FCST_GRP,
I.PROD_GRP_LKEY as PROD_GRP_LKEY,
//  I.PROD_CTGY_LKEY as I_PROD_CTGY_LKEY,
//  D.PROD_CTGY_LKEY as D_PROD_CTGY_LKEY,
NVL(I.PROD_CTGY_LKEY, D.PROD_CTGY_LKEY) as PROD_CTGY_LKEY,
//  I.GENERAL_ITEM_CTGY_LKEY as I_GENERAL_ITEM_CTGY_LKEY,
//   D.GENERAL_ITEM_CTGY_LKEY as D_GENERAL_ITEM_CTGY_LKEY,
  
NVL(I.GENERAL_ITEM_CTGY_LKEY, D.GENERAL_ITEM_CTGY_LKEY) as GENERAL_ITEM_CTGY_LKEY,
//  I.PROD_FAMILY_NAME as I_PROD_FAMILY_NAME,
//   D.PROD_FAMILY_NAME as D_PROD_FAMILY_NAME,
NVL(I.PROD_FAMILY_NAME, D.PROD_FAMILY_NAME)  as PROD_FAMILY_NAME,
//  I.PROD_LN_LKEY as I_PROD_LN_LKEY,
//  D.PROD_LN_LKEY as D_PROD_LN_LKEY,
  
NVL(I.PROD_LN_LKEY, D.PROD_LN_LKEY)  as PROD_LN_LKEY,
//  I.BRAND_LKEY as I_BRAND_LKEY,
//    D.BRAND_LKEY as D_BRAND_LKEY,
  
NVL(I.BRAND_LKEY, D.BRAND_LKEY) as BRAND_LKEY,
I.PROD_TYP_LKEY as PROD_TYP_LKEY,
I.SESNLTY_TEXT as SESNLTY_TEXT,
I.DIM_TEXT as DIM_TEXT,
I.PROD_STAT_TYP as PROD_STAT_TYP,
 D.DMD_UNT_STAT,
I.EFTV_DTE as EFTV_DTE,
I.CSTM_ITEM_CLS as CSTM_ITEM_CLS,
I.PLAN_NBR as PLAN_NBR,
D.DMD_UNT_LVL as DMD_UNT_LVL,
D.PLNG_ITEM_NAME as PLNG_ITEM_NAME,
//  I.BRAND_TEXT as I_BRAND_TEXT,
//  D.BRAND_TEXT as D_BRAND_TEXT,
NVL(I.BRAND_TEXT, D.BRAND_TEXT) as BRAND_TEXT,
I.DMDUNIT_CREATE_FLAG as DMDUNIT_CREATE_FLAG,
I.ATTR_ASGN_FLAG as ATTR_ASGN_FLAG,
//  I.PRIM_CUST as I_PRIM_CUST,
//  D.PRIM_CUST as D_PRIM_CUST,
NVL(I.PRIM_CUST, D.PRIM_CUST) as PRIM_CUST,
//  I.PROD_PLTFRM as I_PROD_PLTFRM,
//  D.PROD_PLTFRM as D_PROD_PLTFRM,
NVL(I.PROD_PLTFRM, D.PROD_PLTFRM) as PROD_PLTFRM,
I.SOP_GRP_LKEY as SOP_GRP_LKEY,
I.MODL_YR as MODL_YR,
I.CUT_WDTH as CUT_WDTH,
I.DECK_MATL as DECK_MATL,
I.DECK_SZ as DECK_SZ,
I.DSCHG_LKEY as DSCHG_LKEY,
I.FRNT_WHL_SZ as FRNT_WHL_SZ,
I.REAR_WHL_SZ as REAR_WHL_SZ,
I.STYLE as STYLE,
I.TRNMSN_LKEY as TRNMSN_LKEY,
I.WPD_HIER_LVL_1 as WPD_HIER_LVL_1,
I.WPD_HIER_LVL_2 as WPD_HIER_LVL_2,
I.WPD_HIER_LVL_3 as WPD_HIER_LVL_3,
I.REUSBL_PKG_FLAG as REUSBL_PKG_FLAG,
I.PLNG_BOM as PLNG_BOM,
I.DECK_LIFT as DECK_LIFT,
I.DECK_WASH as DECK_WASH,
I.ENGN_BRAND as ENGN_BRAND,
I.ENGN_COOLN as ENGN_COOLN,
I.ENGN_CYLNDR as ENGN_CYLNDR,
I.ENGN_DSPLCE as ENGN_DSPLCE,
I.ENGN_NBR as ENGN_NBR,
I.FRNT_TRD as FRNT_TRD,
I.FUEL_SYS as FUEL_SYS,
I.FUEL_TANK as FUEL_TANK,
I.HP as HP,
I.ITEM_ACC_CLS_CD as ITEM_ACC_CLS_CD,
I.LOD_CPCTY as LOD_CPCTY,
I.MNTR as MNTR,
I.PWR_SRC as PWR_SRC,
I.PTO as PTO,
I.REAR_TRD as REAR_TRD,
I.RMC as RMC,
I.SEAT as SEAT,
I.SPEED as SPEED,
I.STARTR as STARTR,
I.SHARED_ITEM as SHARED_ITEM
from ITEM I
LEFT join DMD D
on I.PROD_KEY=D.PROD_KEY),

ONLY_DMD as (

  select * from DMD
   where NOT EXISTS (SELECT PROD_KEY FROM ITEM
                    WHERE ITEM.PROD_KEY=DMD.PROD_KEY)
),

MAP as (

select PROD_KEY,
SRC_SYS_KEY,
RCRD_HASH_KEY,
DEL_FROM_SRC_FLAG,
ETL_INS_PID,
ETL_INS_DTE,
ETL_UPD_PID,
ETL_UPD_DTE,
ZONE3_LOD_DTE,
EFF_DTE,
EXPR_DTE,
CURR_RCRD_FLAG,
ORP_RCRD_FLAG,
SUPPLY_UNIT_DESC,
DYN_DPLY_QTY,
PROD_PERISHABLE_FLAG,
PROD_DMD_PRYRT_NBR,
case when DEL_FLAG  IS NULL then 'U'
when UPPER(DEL_FLAG ) in ('YES','TRUE','1') then 'Y'
when UPPER(DEL_FLAG ) in ('NO','FALSE','0') then 'N' else 'U' END as DEL_FLAG,
GLB_ABC,
GLB_PLNR,
PROD_UNIT_PRC,
SUPPLY_UOM_DESC,
WGT,
VOL,
PROD_ALLOC_POLICY,
CUM_LEADTIME_DUR_CALC,
DYN_DPLY_SKU_VAL,
DYN_DPLY_SRC_COST,
UOM_ID,
DYN_DPLY_DECIMAL_PLACE,
DYN_DPLY_OPT,
DYN_DPLY_PUSH_PULL_INDCTR,
ITEM_CLS,
ITEM_PLAN_LVL,
RESTRCT_PLAN_MODE,
SUPERSESSION_GRP_NBR,
PROD_PAL_UNIT_NBR,
DMD_UNIT_NAME,
DMD_UNIT_DESC,
DMD_UNIT_CREATE_DTE,
MFG_LOC,
DMD_UOM_DESC,
CMT_DESC,
USER_TEXT,
FCST_GRP,
PROD_GRP_LKEY,
PROD_CTGY_LKEY,
GENERAL_ITEM_CTGY_LKEY,
PROD_FAMILY_NAME,
PROD_LN_LKEY,
BRAND_LKEY,
PROD_TYP_LKEY,
SESNLTY_TEXT,
DIM_TEXT,
PROD_STAT_TYP,
DMD_UNT_STAT,
EFTV_DTE,
CSTM_ITEM_CLS,
PLAN_NBR,
DMD_UNT_LVL,
PLNG_ITEM_NAME,
BRAND_TEXT,
DMDUNIT_CREATE_FLAG,
ATTR_ASGN_FLAG,
PRIM_CUST,
PROD_PLTFRM,
SOP_GRP_LKEY,
MODL_YR,
CUT_WDTH,
DECK_MATL,
DECK_SZ,
DSCHG_LKEY,
FRNT_WHL_SZ,
REAR_WHL_SZ,
STYLE,
TRNMSN_LKEY,
WPD_HIER_LVL_1,
WPD_HIER_LVL_2,
WPD_HIER_LVL_3,
REUSBL_PKG_FLAG,
PLNG_BOM,
DECK_LIFT,
DECK_WASH,
ENGN_BRAND,
ENGN_COOLN,
ENGN_CYLNDR,
ENGN_DSPLCE,
ENGN_NBR,
FRNT_TRD,
FUEL_SYS,
FUEL_TANK,
HP,
ITEM_ACC_CLS_CD,
LOD_CPCTY,
MNTR,
PWR_SRC,
PTO,
REAR_TRD,
RMC,
SEAT,
SPEED,
STARTR,
SHARED_ITEM

from UNQ

union all

select PROD_KEY,
SRC_SYS_KEY,
RCRD_HASH_KEY,
DEL_FROM_SRC_FLAG,
ETL_INS_PID,
ETL_INS_DTE,
ETL_UPD_PID,
ETL_UPD_DTE,
ZONE3_LOD_DTE,
EFF_DTE,
EXPR_DTE,
CURR_RCRD_FLAG,
ORP_RCRD_FLAG,

SUPPLY_UNIT_DESC,
DYN_DPLY_QTY,
PROD_PERISHABLE_FLAG,
PROD_DMD_PRYRT_NBR,
case when DEL_FLAG  IS NULL then 'U'
when UPPER(DEL_FLAG ) in ('YES','TRUE','1') then 'Y'
when UPPER(DEL_FLAG ) in ('NO','FALSE','0') then 'N' else 'U'  end as DEL_FLAG,
GLB_ABC,
GLB_PLNR,
PROD_UNIT_PRC,
SUPPLY_UOM_DESC,
WGT,
VOL,
PROD_ALLOC_POLICY,
CUM_LEADTIME_DUR_CALC,
DYN_DPLY_SKU_VAL,
DYN_DPLY_SRC_COST,
UOM_ID,
DYN_DPLY_DECIMAL_PLACE,
DYN_DPLY_OPT,
DYN_DPLY_PUSH_PULL_INDCTR,
ITEM_CLS,
ITEM_PLAN_LVL,
RESTRCT_PLAN_MODE,
SUPERSESSION_GRP_NBR,
PROD_PAL_UNIT_NBR,
DMD_UNIT_NAME,
DMD_UNIT_DESC,
DMD_UNIT_CREATE_DTE,
MFG_LOC,
DMD_UOM_DESC,
CMT_DESC,
USER_TEXT,
FCST_GRP,
PROD_GRP_LKEY,
PROD_CTGY_LKEY,
GENERAL_ITEM_CTGY_LKEY,
PROD_FAMILY_NAME,
PROD_LN_LKEY,
BRAND_LKEY,
PROD_TYP_LKEY,
SESNLTY_TEXT,
DIM_TEXT,
PROD_STAT_TYP,
DMD_UNT_STAT,
EFTV_DTE,
CSTM_ITEM_CLS,
PLAN_NBR,
DMD_UNT_LVL,
PLNG_ITEM_NAME,
BRAND_TEXT,
DMDUNIT_CREATE_FLAG,
ATTR_ASGN_FLAG,
PRIM_CUST,
PROD_PLTFRM,
SOP_GRP_LKEY,
MODL_YR,
CUT_WDTH,
DECK_MATL,
DECK_SZ,
DSCHG_LKEY,
FRNT_WHL_SZ,
REAR_WHL_SZ,
STYLE,
TRNMSN_LKEY,
WPD_HIER_LVL_1,
WPD_HIER_LVL_2,
WPD_HIER_LVL_3,
REUSBL_PKG_FLAG,
PLNG_BOM,
DECK_LIFT,
DECK_WASH,
ENGN_BRAND,
ENGN_COOLN,
ENGN_CYLNDR,
ENGN_DSPLCE,
ENGN_NBR,
FRNT_TRD,
FUEL_SYS,
FUEL_TANK,
HP,
ITEM_ACC_CLS_CD,
LOD_CPCTY,
MNTR,
PWR_SRC,
PTO,
REAR_TRD,
RMC,
SEAT,
SPEED,
STARTR,
SHARED_ITEM
from ONLY_DMD
)

select distinct * from MAP

