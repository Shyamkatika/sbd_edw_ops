SELECT     
upper(LOC.LOC) AS LOC_KEY,
'BLUEYONDER' AS  {{var('column_srcsyskey')}},  
MD5(upper(LOC.LOC)) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
LOC.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
LOC.LOADDTS AS {{var('column_z3loddtm')}},
LOC.U_COUNTRY AS CNTRY_CD,
LOC.DESCR AS LOC_DESC2,
case when LOC.ENABLESW IS NULL then 'U' when UPPER(LOC.ENABLESW) in ('YES','TRUE','1') then 'Y'
when UPPER(LOC.ENABLESW) in ('NO','FALSE','0') then 'N' else 'U' end as LOC_OPTIMIZER_FLAG,
LOC.FRZSTART AS FREEZING_PERD_START_DTE,
LOC.LAT AS LOC_LATITUDE,
LOC.LOC AS LOC_ID,
LOC.TYPE AS LOC_TYP_CD,
LOC.LON AS LOC_LONGITUDE,
LOC.OHPOST AS ON_HAND_POST_DTE,
LOC.POSTALCODE AS CNTRY_PSTL_CD,
LOC.SEQINTEXPORTDUR AS SEQUENTIAL_EXPORT_DUR,
LOC.SEQINTIMPORTDUR AS SEQUENTIAL_IMPORT_DUR,
LOC.SEQINTLASTEXPORTEDTOSEQ AS SEQUENTIAL_LAST_EXPORT_DUR_DTE,
LOC.SEQINTLASTIMPORTEDFROMSEQ AS SEQUENTIAL_LAST_IMPORT_DUR_DTE,
LOC.U_LOC_LVL AS HIER_LVL,
LOC.U_LOC_TYPE AS LOC_OWN_PARTY_TYP_LKEY,
LOC.U_LOC_H_LVL_1 AS HIER_LVL_2,
LOC.U_COUNTRY AS CNTRY_CD_LKEY,
LOC.U_BUS_SEG AS BUS_SEG
FROM {{source('BLUEYONDER','LOC')}} LOC
where  ASCII(LOC.LOC)<>32 or len(LTRIM(RTRIM(LOC.LOC)))<>0