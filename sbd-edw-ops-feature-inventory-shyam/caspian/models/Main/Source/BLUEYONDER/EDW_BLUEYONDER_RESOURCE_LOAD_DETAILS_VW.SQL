SELECT
UPPER (CONCAT(COALESCE(RESLOADDETAIL.DMDORDERTYPE::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.DMDORDERSEQNUM::VARCHAR,''), '~', COALESCE(RESLOADDETAIL.SUPPLYSEQNUM::VARCHAR,''),'~', 
COALESCE(RESLOADDETAIL.WHENLOADED::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.STEPNUM::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.PRODUCTIONMETHOD::VARCHAR,''),'~', 
COALESCE(RESLOADDETAIL.SUPPLYTYPE::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.RES::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.LOC::VARCHAR,''),'~',
COALESCE(RESLOADDETAIL.ITEM::VARCHAR,''))) AS RESOURCE_LOD_DETAILS_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},
MD5(UPPER (CONCAT(COALESCE(RESLOADDETAIL.DMDORDERTYPE::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.DMDORDERSEQNUM::VARCHAR,''), '~', COALESCE(RESLOADDETAIL.SUPPLYSEQNUM::VARCHAR,''),'~', 
COALESCE(RESLOADDETAIL.WHENLOADED::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.STEPNUM::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.PRODUCTIONMETHOD::VARCHAR,''),'~', 
COALESCE(RESLOADDETAIL.SUPPLYTYPE::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.RES::VARCHAR,''),'~', COALESCE(RESLOADDETAIL.LOC::VARCHAR,''),'~',
COALESCE(RESLOADDETAIL.ITEM::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
RESLOADDETAIL.LOADDTS as {{var('column_z3loddtm')}},
RESLOADDETAIL.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
--RESLOADDETAIL.CUSTORDLOADQTY	AS	CUST_ORD_LOD_QTY,
to_number(RESLOADDETAIL.CUSTORDLOADQTY,28,10)	AS	CUST_ORD_LOD_QTY,
RESLOADDETAIL.DMDNEEDDATE	AS	DMD_NEED_DTE,
RESLOADDETAIL.DMDORDERSEQNUM	AS	DMD_ORD_SEQ_NBR,
RESLOADDETAIL.DMDORDERTYPE	AS	DMD_ORD_TYP,
--RESLOADDETAIL.FCSTORDLOADQTY	AS	FCST_ORD_LOD_QTY,
to_number(RESLOADDETAIL.FCSTORDLOADQTY,28,10)	AS	FCST_ORD_LOD_QTY,
RESLOADDETAIL.ITEM	AS	PROD_KEY,
--RESLOADDETAIL.LOADQTY	AS	LOD_QTY,
to_number(RESLOADDETAIL.LOADQTY,28,10) AS LOD_QTY,
RESLOADDETAIL.LOC AS LOC_KEY,
RESLOADDETAIL.NEEDDATE	AS	NEED_DTE,
RESLOADDETAIL.OFFSET	AS	OFFSET_NBR,
RESLOADDETAIL.OPTIONSETNAME	AS	OPT_SET_NAME,
RESLOADDETAIL.PROCESSID	AS	PID_NBR,
RESLOADDETAIL.PRODUCTIONMETHOD	AS	PRODTN_MTHD_KEY,
RESLOADDETAIL.RES	AS	LOD_RESOURCE_NAME,
RESLOADDETAIL.ROUTINGNEEDCOMPLETEDATE	AS	RTG_NEED_CMPLT_DTE,
RESLOADDETAIL.SCHEDDATE	AS	SCHED_DTE,
--RESLOADDETAIL.SSLOADQTY	AS	STK_LOD_QTY,
to_number(RESLOADDETAIL.SSLOADQTY,28,10) AS	STK_LOD_QTY,
RESLOADDETAIL.STARTDATE	AS	PLAN_ORD_START_DTE,
RESLOADDETAIL.STEPNUM	AS	PRODTN_STEP_NBR,
RESLOADDETAIL.SUPPLYORDERNUM	AS	SUPPLY_ORD_NBR,
RESLOADDETAIL.SUPPLYORDERSEQNUM	AS	SUPPLY_ORD_SEQ_NBR,
--RESLOADDETAIL.SUPPLYQTY	AS	SUPPLY_QTY,
to_number(RESLOADDETAIL.SUPPLYQTY,28,10) AS	SUPPLY_QTY,
RESLOADDETAIL.SUPPLYSEQNUM	AS	SUPPLY_SEQ_NBR,
RESLOADDETAIL.SUPPLYTYPE	AS	SUPPLY_TYP,
RESLOADDETAIL.WHENLOADED	AS	LOD_DTE
FROM {{source('BLUEYONDER','RESLOADDETAIL')}} RESLOADDETAIL