SELECT
upper(RES.RES) AS RESOURCE_KEY,
'BLUEYONDER' AS  {{var('column_srcsyskey')}},  
MD5(upper(RES.RES)) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
RES.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
RES.LOADDTS AS {{var('column_z3loddtm')}},
RES.ADDONCOST	AS	ONE_UNIT_CAPACITY_COST,
RES.ADJFACTOR	AS	ADJ_FACTOR,
RES.AVGFAMILYCHG	AS	AVG_FAMILY_CHANGES_NBR,
RES.AVGFAMILYCHGCOST	AS	AVG_FAMILY_CHANGES_COST,
RES.AVGSKUCHG	AS	AVG_SKU_CHG_NBR,
RES.AVGSKUCHGCOST	AS	AVG_SKU_CHG_COST,
RES.BUCKETSW	AS	BUCKET_SPECIFIES_CAPACITY,
RES.CAL	AS	ASSCTD_RESOURCE_CLNDR,
RES.CHECKMAXCAP	AS	CAPACITY_CNSTRNT_TYP,
RES.COST	AS	RESOURCE_PER_UNIT_CAPACITY_COST,
RES.CRITICALITEM	AS	CRTCL_ITEM,
RES.CURRENCYUOM	AS	UOM_CRNCY,
RES.DESCR	AS	RESOURCE_DESC,
case when RES.ENABLESW IS NULL then 'U' when UPPER(RES.ENABLESW) in ('YES','TRUE','1') then 'Y'
when UPPER(RES.ENABLESW) in ('NO','FALSE','0') then 'N' else 'U' end as RESOURCE_OPTIMIZER_FLAG,
RES.INCUNUSEDUR	AS	RESOURCE_INCREMENTAL_DUR,
case when RES.LEVELLOADSW IS NULL then 'U' when UPPER(RES.LEVELLOADSW) in ('YES','TRUE','1') then 'Y'
when UPPER(RES.LEVELLOADSW) in ('NO','FALSE','0') then 'N' else 'U' end as LOD_LVL_FLAG,
RES.LEVELSEQNUM	AS	LVL_SEQ_NBR,
RES.LOC	AS	LOC_KEY,
case when RES.OVERTIMESW IS NULL then 'U' when UPPER(RES.OVERTIMESW) in ('YES','TRUE','1') then 'Y'
when UPPER(RES.OVERTIMESW) in ('NO','FALSE','0') then 'N' else 'U' end as RESOURCE_OVTM_CAPACITY_FLAG,
case when RES.PEGGINGSW IS NULL then 'U' when UPPER(RES.PEGGINGSW) in ('YES','TRUE','1') then 'Y'
when UPPER(RES.PEGGINGSW) in ('NO','FALSE','0') then 'N' else 'U' end as RESOURCE_PEGGING_RESLT_FLAG,
RES.PRODSMOOTHCAL	AS	PRODTN_SMOOTHING_CLNDR,
RES.PRODSMOOTHINITLOAD	AS	PRODTN_INIT_LOD,
RES.PRODUCTIONFAMILYCHGOVEROPT	AS	PRODTN_FAMILY_CHG_OVER_OPT,
RES.QTYUOM	AS	UOM_QTY,
RES.RELEASEFENCEDUR	AS	RELS_FENCE_DUR,
RES.RES	AS	RESOURCE_GRP,
RES.SHIFTSIZE	AS	SHFT_SZ,
RES.SOURCE	AS	RESOURCE_SRC_LOC_TYP,
RES.STAGE	AS	RESOURCE_STG_NAME,
RES.STORAGECLASS	AS	STORG_CAPACITY_CLS,
RES.STORAGEGROUP	AS	ITEM_STORG_GRP_NAME,
RES.TYPE	AS	RESOURCE_TYP,
RES.MINQUEUETIME	AS	MIN_QUEUE_TM,
RES.ESTMTDQUEUETIME	AS	EST_QUEUE_TM,
RES.ENABLEOPT	AS	RCRD_ENABLE_OPT,
RES.U_ALL	AS	INDCTR,
RES.U_RESGROUP	AS	RESOURCE_GRP_CTGY
FROM {{source('BLUEYONDER','RES')}} RES
WHERE upper(RES.RES) <> ' '