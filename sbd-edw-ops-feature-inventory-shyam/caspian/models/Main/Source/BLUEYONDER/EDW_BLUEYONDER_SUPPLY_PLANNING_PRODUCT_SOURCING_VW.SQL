SELECT 	
UPPER(CONCAT(COALESCE(SOURCING.ITEM::VARCHAR,''),'~', COALESCE(SOURCING.DEST::VARCHAR,''), '~', 
COALESCE(SOURCING.SOURCE::VARCHAR,''), '~', COALESCE(SOURCING.SOURCING::VARCHAR,''))) AS SUPPLY_PLNG_PROD_SOURCING_KEY,
'BLUEYONDER' AS  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(SOURCING.ITEM::VARCHAR,''),'~', COALESCE(SOURCING.DEST::VARCHAR,''), '~', 
COALESCE(SOURCING.SOURCE::VARCHAR,''), '~', COALESCE(SOURCING.SOURCING::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
SOURCING.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
SOURCING.LOADDTS AS {{var('column_z3loddtm')}},
SOURCING.ARRIVCAL AS ARRVL_CLNDR_ID,
SOURCING.DEST AS DEST_LOC_KEY,
SOURCING.ITEM AS PROD_KEY,
SOURCING.REVIEWCAL AS RVW_CLNDR_ID,
SOURCING.SHIPCAL AS SHIP_CLNDR_ID,
SOURCING.SOURCE AS SRC_LOC_KEY,
SOURCING.SOURCING AS SOURCING_TYP,
SOURCING.TRANSMODE AS TRNSPRT_MODE,
SOURCING.DISC AS DISCONTINUATION_DTE,
SOURCING.EFF AS PLAN_EFF_START_DTE,
SOURCING.NONEWSUPPLYDATE AS NO_NEW_SUPPLY_DTE,
SOURCING.EXPEDITECOST AS TRANSIT_EXPEDITE_COST,
SOURCING.FACTOR AS FACTOR,
SOURCING.ROUNDINGFACTOR AS RND_FACTOR,
SOURCING.SHRINKAGEFACTOR AS SHRINKAGE_FACTOR,
SOURCING.YIELDFACTOR AS YIELD_FACTOR_VAL,
SOURCING.LOADDUR AS LOD_DUR,
SOURCING.UNLOADDUR AS UNLD_DUR,
SOURCING.MAJORSHIPQTY AS MIN_SHIP_QTY,
SOURCING.MINORSHIPQTY AS INCREMENTAL_SHIP_QTY,
SOURCING.SPLITQTY AS MIN_SPLIT_QTY,
SOURCING.MAXSHIPQTY AS MAX_SHIP_QTY,
SOURCING.PRIORITY AS SOURCING_PRYRT_NBR,
SOURCING.MAXLEADTIME AS MAX_LEADTIME_DUR,
SOURCING.MINLEADTIME AS MIN_LEADTIME_DUR,
SOURCING.SUPPLYLEADTIME AS SUPPLY_LEAD_TIMEDURATION,
case when SOURCING.LOTSIZESENABLEDSW IS NULL then 'U' when UPPER(SOURCING.LOTSIZESENABLEDSW) in ('YES','TRUE','1') then 'Y'
when UPPER(SOURCING.LOTSIZESENABLEDSW) in ('NO','FALSE','0') then 'N' else 'U' end as LOT_SZ_ENABLED_FLAG,
SOURCING.CONVENIENTADJDOWNPCT AS EARLIER_CONVENIENT_SHIP_QTY,
SOURCING.CONVENIENTADJUPPCT AS NEXT_CONVENIENT_SHIP_QTY,
SOURCING.CONVENIENTOVERRIDETHRESHOLD AS THRESHOLD_CONVENIENT_SHIP_QTY,
case when SOURCING.ENABLESW IS NULL then 'U' when UPPER(SOURCING.ENABLESW) in ('YES','TRUE','1') then 'Y'
when UPPER(SOURCING.ENABLESW) in ('NO','FALSE','0') then 'N' else 'U' end as OPTIMIZATION_OPTIMIZER_FLAG,
SOURCING.PULLFORWARDDUR AS PULL_FORWARD_DUR,
case when SOURCING.USELOOKAHEADSW  IS NULL then 'U' when UPPER(SOURCING.USELOOKAHEADSW ) in ('YES','TRUE','1') then 'Y'
when UPPER(SOURCING.USELOOKAHEADSW ) in ('NO','FALSE','0') then 'N' else 'U' end as USE_LOOK_AHEAD_FLAG
FROM {{source('BLUEYONDER','SOURCING')}} SOURCING

