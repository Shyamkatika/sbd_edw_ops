SELECT 
UPPER (CONCAT(COALESCE(PRODUCTIONSTEP.PRODUCTIONMETHOD::VARCHAR,''),'~',COALESCE(PRODUCTIONSTEP.STEPNUM::VARCHAR,''),'~', COALESCE(PRODUCTIONSTEP.ITEM::VARCHAR,''),
'~', COALESCE(PRODUCTIONSTEP.LOC::VARCHAR,''),'~', COALESCE(PRODUCTIONSTEP.EFF::VARCHAR,''))) AS PRODTN_MTHD_STEP_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER (CONCAT(COALESCE(PRODUCTIONSTEP.PRODUCTIONMETHOD::VARCHAR,''),'~',COALESCE(PRODUCTIONSTEP.STEPNUM::VARCHAR,''),'~', COALESCE(PRODUCTIONSTEP.ITEM::VARCHAR,''),
'~', COALESCE(PRODUCTIONSTEP.LOC::VARCHAR,''),'~', COALESCE(PRODUCTIONSTEP.EFF::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
PRODUCTIONSTEP.LOADDTS as {{var('column_z3loddtm')}},
PRODUCTIONSTEP.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
PRODUCTIONSTEP.PRODUCTIONMETHOD	AS	PRODTN_MTHD_KEY,
PRODUCTIONSTEP.ITEM	AS	PROD_KEY,
PRODUCTIONSTEP.LOC	AS	LOC_KEY,
PRODUCTIONSTEP.PRODRATECAL	AS	PRODTN_RATE_CLNDR_ID,
PRODUCTIONSTEP.QTYUOM	AS	UOM_ID,
PRODUCTIONSTEP.RES	AS	ASSCTD_RESOURCE_KEY,
PRODUCTIONSTEP.NEXTSTEPTIMING	AS	NEXT_STEP_TIMING_MTHD,
PRODUCTIONSTEP.PRODFAMILY	AS	PRODTN_FAMILY,
PRODUCTIONSTEP.EFF	AS	PRODTN_STEP_START_DTE,
PRODUCTIONSTEP.PRODCOST	AS	PRODTN_UNIT_COST,
PRODUCTIONSTEP.STEPNUM	AS	PRODTN_MTHD_STEP_NBR,
PRODUCTIONSTEP.FIXEDRESREQ	AS	FIXED_RESOURCE_CAPACITY_CNT,
PRODUCTIONSTEP.LOADOFFSETDUR	AS	LOD_OFFSET_DUR,
PRODUCTIONSTEP.MAXSTARTDUR	AS	MAX_DUR,
PRODUCTIONSTEP.PRODDUR	AS	PRODTN_DUR,
PRODUCTIONSTEP.PRODOFFSET	AS	PRODTN_OFFSET_DUR,
PRODUCTIONSTEP.BASEYIELD	AS	BASE_YIELD_FACTOR,
PRODUCTIONSTEP.PRODRATE	AS	PRODTN_RATE,
PRODUCTIONSTEP.DESCR	AS	PRODTN_STEP_DESC,
case when PRODUCTIONSTEP.ENABLESW IS NULL then 'U' when UPPER(PRODUCTIONSTEP.ENABLESW) in ('YES','TRUE','1') then 'Y'
when UPPER(PRODUCTIONSTEP.ENABLESW) in ('NO','FALSE','0') then 'N' else 'U' end as PRODTN_MTHD_OPTIMIZER_FLAG,
PRODUCTIONSTEP.INUSEBEFORESW	AS	PRODTN_STEP_ACTV_FLAG,
PRODUCTIONSTEP.SETUP	AS	PRODTN_STEP_SETUP_ID,
PRODUCTIONSTEP.SPREAD	AS	COMPUTED_LOD_DUR
FROM {{source('BLUEYONDER','PRODUCTIONSTEP')}} PRODUCTIONSTEP
