SELECT
UPPER(CONCAT(COALESCE(trim(SKUEXCEPTION.FUNCTIONNUM),''),'~',COALESCE(trim(SKUEXCEPTION.LEVELNUM),'')
,'~',COALESCE(trim(SKUEXCEPTION.PROCESSID),''),'~',COALESCE(trim(SKUEXCEPTION.SEQNUM),''),'~',COALESCE(trim(SKUEXCEPTION.BATCHNUM),''))) AS SKU_EXCEPTION_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(trim(SKUEXCEPTION.FUNCTIONNUM),''),'~',COALESCE(trim(SKUEXCEPTION.LEVELNUM),'')
,'~',COALESCE(trim(SKUEXCEPTION.PROCESSID),''),'~',COALESCE(trim(SKUEXCEPTION.SEQNUM),''),'~',COALESCE(trim(SKUEXCEPTION.BATCHNUM),'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
SKUEXCEPTION.LOADDTS as {{var('column_z3loddtm')}},
SKUEXCEPTION.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
SKUEXCEPTION.EXCEPTION		AS	EXCEPTION,
SKUEXCEPTION.DESCR			AS	DESCR,
SKUEXCEPTION.EXCEPTIONDATE	AS	EXCEPTIONDATE,
SKUEXCEPTION.FUNCTIONNAME	AS	FUNCTIONNAME,
SKUEXCEPTION.FUNCTIONNUM	AS	FUNCTIONNUM,
SKUEXCEPTION.ITEM			AS	PROD_KEY,
SKUEXCEPTION.LOC			AS	LOC_KEY,
SKUEXCEPTION.WHEN			AS	WHEN,
SKUEXCEPTION.LEVELNUM		AS	LEVELNUM,
SKUEXCEPTION.PROCESSID		AS	PROCESSID,
SKUEXCEPTION.SEQNUM			AS	SEQNUM,
SKUEXCEPTION.BATCHNUM		AS	BATCHNUM
FROM {{source('BLUEYONDER','SKUEXCEPTION')}} SKUEXCEPTION
