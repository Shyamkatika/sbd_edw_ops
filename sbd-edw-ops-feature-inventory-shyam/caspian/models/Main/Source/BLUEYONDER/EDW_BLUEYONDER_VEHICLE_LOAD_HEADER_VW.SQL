SELECT     
UPPER(VEHICLELOAD.LOADID) AS VHCL_LOD_HDR_KEY,
'BLUEYONDER' AS  {{var('column_srcsyskey')}},  
MD5(UPPER(VEHICLELOAD.LOADID)) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
VEHICLELOAD.LOADDTS AS  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
VEHICLELOAD.LOADDTS AS {{var('column_z3loddtm')}},
case when VEHICLELOAD.APPROVALSTATUS IS NULL then 'U' when UPPER(VEHICLELOAD.APPROVALSTATUS) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.APPROVALSTATUS) in ('NO','FALSE','0') then 'N' else 'U' end as LOD_APRV_FLAG,
VEHICLELOAD.ARRIVDATE AS LOD_ARRVL_DTE,
VEHICLELOAD.CONSOLIDATEDLOADSEQNUM AS CONSOLIDATED_LOD_SEQ_NBR,
VEHICLELOAD.LOADID AS VHCL_LOD_ID,
VEHICLELOAD.DESCR AS VHCL_LOD_DESC,
VEHICLELOAD.DESTSTATUS AS VHCL_LOD_TRNSPRT_STAT,
case when VEHICLELOAD.EXPORTED IS NULL then 'U' when UPPER(VEHICLELOAD.EXPORTED) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.EXPORTED) in ('NO','FALSE','0') then 'N' else 'U' end as LOD_ALREADY_EXPORTED_FLAG,
VEHICLELOAD.GROUPORDERID AS VHCL_LOD_GRP_ORD_ID,
VEHICLELOAD.LANEGROUPID AS VHCL_LOD_LANE_GRP_ID,
case when VEHICLELOAD.LANEGROUPMINMETSW IS NULL then 'U' when UPPER(VEHICLELOAD.LANEGROUPMINMETSW) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.LANEGROUPMINMETSW) in ('NO','FALSE','0') then 'N' else 'U' end as LANE_GRP_MET_MIN_FLAG,
VEHICLELOAD.LBSOURCE AS VHCL_LOD_ORIG_STAT,
VEHICLELOAD.LBSTATUS AS LOD_BUILDING_STAT_NBR,
case when VEHICLELOAD.LOADSW IS NULL then 'U' when UPPER(VEHICLELOAD.LOADSW) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.LOADSW) in ('NO','FALSE','0') then 'N' else 'U' end as ADDTN_LOD_POSBL_FLAG,
case when VEHICLELOAD.LSRULEMETSW IS NULL then 'U' when UPPER(VEHICLELOAD.LSRULEMETSW) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.LSRULEMETSW) in ('NO','FALSE','0') then 'N' else 'U' end as LOD_SATISFACTION_RULE_MET_FLAG,
case when VEHICLELOAD.MAXCAPACITYEXCEEDEDSW IS NULL then 'U' when UPPER(VEHICLELOAD.MAXCAPACITYEXCEEDEDSW) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.MAXCAPACITYEXCEEDEDSW) in ('NO','FALSE','0') then 'N' else 'U' end as MAX_CAPACITY_EXCEEDED_FLAG,
case when VEHICLELOAD.MAXCAPACITYMETSW IS NULL then 'U' when UPPER(VEHICLELOAD.MAXCAPACITYMETSW) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.MAXCAPACITYMETSW) in ('NO','FALSE','0') then 'N' else 'U' end as MAX_CAPACITY_MET_FLAG,
VEHICLELOAD.ORDERID AS VHCL_LOD_ORD_NBR,
VEHICLELOAD.ORDEROPTSEQNUM AS VHCL_LOD_SEQ_NBR,
VEHICLELOAD.SHIPDATE AS LOD_DISPATCHED_DTE,
VEHICLELOAD.SOURCESTATUS AS LOD_QTY_SHIP_STAT,
VEHICLELOAD.STATUSDESC AS STAT_DESC,
VEHICLELOAD.STATUSDESCR AS STAT_VAL,
case when VEHICLELOAD.TOLERANCECAPMETSW IS NULL then 'U' when UPPER(VEHICLELOAD.TOLERANCECAPMETSW) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.TOLERANCECAPMETSW) in ('NO','FALSE','0') then 'N' else 'U' end as TLRNCE_CAPACITY_MET_FLAG,
VEHICLELOAD.TRANSMODE AS TRNSPRT_MODE,
case when VEHICLELOAD.TRANSMODEMINMETSW IS NULL then 'U' when UPPER(VEHICLELOAD.TRANSMODEMINMETSW) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.TRANSMODEMINMETSW) in ('NO','FALSE','0') then 'N' else 'U' end as TRNSPRT_MIN_MET_FLAG,
case when VEHICLELOAD.UPDATED IS NULL then 'U' when UPPER(VEHICLELOAD.UPDATED) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.UPDATED) in ('NO','FALSE','0') then 'N' else 'U' end as LOD_MGR_FLAG,
case when VEHICLELOAD.VENDORMINMETSW IS NULL then 'U' when UPPER(VEHICLELOAD.VENDORMINMETSW) in ('YES','TRUE','1') then 'Y'
when UPPER(VEHICLELOAD.VENDORMINMETSW) in ('NO','FALSE','0') then 'N' else 'U' end as VEND_MIN_MET_FLAG
FROM {{source('BLUEYONDER','VEHICLELOAD')}} VEHICLELOAD