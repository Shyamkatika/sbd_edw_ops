SELECT
UPPER(CONCAT(COALESCE(DFUTOSKUFCST.ITEM::VARCHAR,''),'~',COALESCE(DFUTOSKUFCST.SKULOC::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.DMDUNIT::VARCHAR,''),'~',
COALESCE(DFUTOSKUFCST.DMDGROUP::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.DFULOC::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.STARTDATE::VARCHAR,''),'~',
COALESCE(DFUTOSKUFCST.DUR::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.TYPE::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.SUPERSEDESW::VARCHAR,''))) AS DFU_SKU_FCST_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(DFUTOSKUFCST.ITEM::VARCHAR,''),'~',COALESCE(DFUTOSKUFCST.SKULOC::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.DMDUNIT::VARCHAR,''),'~',
COALESCE(DFUTOSKUFCST.DMDGROUP::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.DFULOC::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.STARTDATE::VARCHAR,''),'~',
COALESCE(DFUTOSKUFCST.DUR::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.TYPE::VARCHAR,''),'~', COALESCE(DFUTOSKUFCST.SUPERSEDESW::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
DFUTOSKUFCST.LOADDTS as {{var('column_z3loddtm')}},
DFUTOSKUFCST.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
DFULOC as  DFU_LOC_KEY ,
DMDGROUP as DMD_GRP_KEY ,
DMDUNIT as  DMD_UNIT_KEY ,
DUR as  FCST_DUR_MTH_CNT,
ITEM as  PROD_KEY,
SKULOC as  LOC_KEY,
STARTDATE as  MAP_FCST_START_DTE,
TOTFCST as MAP_FCST_QTY,
TYPE as  MAP_FCST_TYP,
CASE WHEN SUPERSEDESW ='0' then 'N' ELSE 'Y' end as  DFU_SUPERSEDE_FLAG 
FROM {{source('BLUEYONDER','DFUTOSKUFCST')}} DFUTOSKUFCST