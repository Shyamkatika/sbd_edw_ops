SELECT     
UPPER(CONCAT(COALESCE(PRODUCTIONMETHOD.PRODUCTIONMETHOD::VARCHAR,''),'~',COALESCE(PRODUCTIONMETHOD.ITEM::VARCHAR,''),
'~', COALESCE(PRODUCTIONMETHOD.LOC::VARCHAR,''))) AS PRODTN_MTHD_KEY,
'BLUEYONDER' as  {{var('column_srcsyskey')}},  
MD5(UPPER(CONCAT(COALESCE(PRODUCTIONMETHOD.PRODUCTIONMETHOD::VARCHAR,''),'~',COALESCE(PRODUCTIONMETHOD.ITEM::VARCHAR,''),
'~', COALESCE(PRODUCTIONMETHOD.LOC::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} as {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' as {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_INS_DTE')}},
'{{model.name}}' as {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ as {{var('column_ETL_UPD_DTE')}},
PRODUCTIONMETHOD.LOADDTS as {{var('column_z3loddtm')}},
PRODUCTIONMETHOD.LOADDTS as  {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' as {{var('column_verexpirydt')}},
{{var('default_y')}} AS  {{var('column_currrecflag')}},                                                                                    
{{var('default_n')}} AS  {{var('column_orprecflag')}},
PRODUCTIONMETHOD.ITEM	  			AS	PROD_KEY,
PRODUCTIONMETHOD.LEADTIMECAL		AS	SUPPLY_LEADTIME_DUR,
PRODUCTIONMETHOD.LOC				AS	LOC_KEY,
PRODUCTIONMETHOD.LOADOPT			AS	LOD_OPT,
PRODUCTIONMETHOD.OFFSETTYPE			AS	LOD_OFFSET_TYP,
PRODUCTIONMETHOD.PRODFAMILY			AS	PRODTN_FAMILY,
PRODUCTIONMETHOD.PRODGROUP			AS	PROD_GRP,
PRODUCTIONMETHOD.BOMNUM				AS	BOM_NBR,
PRODUCTIONMETHOD.CAMPAIGNPRIORITY	AS	CAMPAIGN_PRYRT_NBR,
PRODUCTIONMETHOD.LEADTIME			AS	PRODTN_LEADTIME_DUR,
PRODUCTIONMETHOD.LEADTIMESTDDEV		AS	STD_DEVN_LEADTIME_DUR,
PRODUCTIONMETHOD.MAXFINDUR			AS	MAX_FINISH_DUR_DY_CNT,
PRODUCTIONMETHOD.PRIORITY			AS	PRYRT_NBR,
PRODUCTIONMETHOD.DISC				AS	PRODTN_EFF_END_DTE,
PRODUCTIONMETHOD.EFF				AS	PRODTN_EFF_START_DTE,
PRODUCTIONMETHOD.CAMPAIGNMINQTY		AS	CAMPAIGN_MIN_QTY,
PRODUCTIONMETHOD.INCQTY				AS	INCREMENTAL_QTY,
PRODUCTIONMETHOD.MAXQTY				AS	LOT_MAX_QTY,
PRODUCTIONMETHOD.MAXSTARTDUR		AS	MAX_DUR_DY_CNT,
PRODUCTIONMETHOD.MINQTY				AS	MIN_PLAN_QTY,
PRODUCTIONMETHOD.PRODCOST			AS	PRODTN_COST,
PRODUCTIONMETHOD.PRODUCTIONMETHOD	AS	PRODTN_MTHD_NAME,
PRODUCTIONMETHOD.DESCR				AS	PRODTN_MTHD_DESC,
PRODUCTIONMETHOD.ENABLESW			AS	PRODTN_MTHD_OPTIMIZER,
PRODUCTIONMETHOD.MAXLEADTIME		AS	MAX_LEADTIME_DY_CNT,
PRODUCTIONMETHOD.MINLEADTIME		AS	MIN_LEADTIME_DY_CNT,
PRODUCTIONMETHOD.NONEWSUPPLYDATE	AS	NO_NEW_SUPPLY_DTE,
PRODUCTIONMETHOD.SPLITFACTOR		AS	INVTY_SPLIT_FACTOR,
PRODUCTIONMETHOD.SPLITORDERSW		AS	INVTY_SPLIT,
PRODUCTIONMETHOD.WORKSCOPE			AS	WORK_SCOPE_DESC,
PRODUCTIONMETHOD.YIELDQTY			AS	YIELD_QTY,
PRODUCTIONMETHOD.U_FRZDUR           AS  FRZ_DUR,
PRODUCTIONMETHOD.FINISHCAL          AS  FINISHED_CLNDR_NAME
FROM {{source('BLUEYONDER','PRODUCTIONMETHOD')}} PRODUCTIONMETHOD