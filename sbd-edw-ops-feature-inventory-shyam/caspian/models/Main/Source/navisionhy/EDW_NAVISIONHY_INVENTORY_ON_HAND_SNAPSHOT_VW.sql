SELECT
'NAVISIONHY' AS {{var('column_srcsyskey')}},
UPPER(CONCAT(coalesce(ITEMLEDGERENTRY.COMPANY::VARCHAR,''),'~',coalesce(ITEMLEDGERENTRY.POSITIVE::VARCHAR,''),'~',coalesce(ITEMLEDGERENTRY.ENTRYNO::VARCHAR,''))) as INVTY_ON_HAND_SNAPSHOT_KEY,
MD5(UPPER(CONCAT(coalesce(ITEMLEDGERENTRY.COMPANY::VARCHAR,''),'~',coalesce(ITEMLEDGERENTRY.POSITIVE::VARCHAR,''),'~',coalesce(ITEMLEDGERENTRY.ENTRYNO::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
ITEMLEDGERENTRY.LOADDTS AS {{var('column_z3loddtm')}},
ITEMLEDGERENTRY.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
TRY_TO_TIMESTAMP(ITEMLEDGERENTRY.REC_CRTD_TIMESTAMP,'YYYY-MM-DD HH:MI:SS.FF') as ENTR_TS,
---ITEMLEDGERENTRY.REC_CRTD_TIMESTAMP	as	ENTR_TS	,--Timestamp '00000071FD3D7F77' is not recognized
ITEMLEDGERENTRY.ENTRYNO	as	ENTR_NBR	,
ITEMLEDGERENTRY.ITEMNO	as	PROD_KEY	,
ITEMLEDGERENTRY.POSTINGDATE	as	PROD_POST_DTE	,
ITEMLEDGERENTRY.ENTRYTYPE	as	ENTR_TXN_TYP_LKEY	,
ITEMLEDGERENTRY.SOURCENO	as	ENTR_SRC_NBR	,
ITEMLEDGERENTRY.DOCUMENTNO	as	ENTR_DOC_NBR	,
ITEMLEDGERENTRY.DESCRIPTION	as	PROD_ENTR_DESC	,
ITEMLEDGERENTRY.LOCATIONCODE	as	LOC_KEY	,
ITEMLEDGERENTRY.QUANTITY	as	PROD_UNIT_QTY	,
ITEMLEDGERENTRY.RemainingQuantity	as	PROD_REMAIN_QTY	,
ITEMLEDGERENTRY.InvoicedQuantity	as	PROD_INVC_QTY	,
ITEMLEDGERENTRY.APPLIES_TOENTRY	as	PROD_ENTR_NBR	,
ITEMLEDGERENTRY.GlobalDimension1Code	as	GLB_DIM_1_CD	,
ITEMLEDGERENTRY.GlobalDimension2Code	as	GLB_DIM_2_CD	,
ITEMLEDGERENTRY.Country_RegionCode	as	CNTRY_CD	,
ITEMLEDGERENTRY.DocumentDate	as	DOC_CREATE_DTE	,
ITEMLEDGERENTRY.EXTERNALDOCUMENTNO	as	EXTNL_DOC_NBR	,
ITEMLEDGERENTRY.No_Series	as	DOC_SERIES_NBR	,
ITEMLEDGERENTRY.DocumentType	as	DOC_TYP_LKEY	,
ITEMLEDGERENTRY.DocumentLineNo	as	DOC_LN_NBR	,
ITEMLEDGERENTRY.OrderNo	as	ENTR_ORD_NBR	,
ITEMLEDGERENTRY.OrderLineNo	as	ENTR_ORD_LN_NBR	,
ITEMLEDGERENTRY.DimensionSetID	as	PROD_DIM_SET_NBR	,
ITEMLEDGERENTRY.Qty_perUnitofMeasure	as	UOM_QTY	,
ITEMLEDGERENTRY.UnitofMeasureCode	as	UOM_TYP_LKEY	,
ITEMLEDGERENTRY.CROSS_REFERENCENO	as	XREF_NBR	,
ITEMLEDGERENTRY.ITEMCATEGORYCODE	as	PROD_CTGY_LKEY	,
ITEMLEDGERENTRY.ProductGroupCode	as	PROD_GRP_LKEY	,
ITEMLEDGERENTRY.LastInvoiceDate	as	LAST_INVC_DTE	,
ITEMLEDGERENTRY.ShippedQty_NotReturned	as	SHIP_NOT_RTRN_QTY	,
ITEMLEDGERENTRY.Prod_OrderComp_LineNo	as	PROD_ORD_CMPNT_LN_NBR	,
ITEMLEDGERENTRY.SerialNo	as	PROD_SERL_NBR	,
ITEMLEDGERENTRY.ConsignBPONo	as	CONSIGN_BPO_NBR	,
---ITEMLEDGERENTRY.ConsignTransNo	as	CONSIGN_TXN_NBR	,
ITEMLEDGERENTRY.ORDERTYPE	as	TXN_TYP_LKEY	,
CASE WHEN ROUND(ITEMLEDGERENTRY.OPEN,0)=1 then 'Y'  WHEN ROUND(ITEMLEDGERENTRY.OPEN,0)=0 then 'N' else 'U' end	as	REMAIN_QTY_FLAG	,
ITEMLEDGERENTRY.ENTRY_EXITPOINT	as	ENTR_EXIT_POINT	,
ITEMLEDGERENTRY.PURCHASINGCODE	as	PROD_PUR_CD	,
CASE WHEN ROUND(ITEMLEDGERENTRY.COMPLETELYINVOICED,0)=1 then 'Y'  WHEN ROUND(ITEMLEDGERENTRY.COMPLETELYINVOICED,0)=0 then 'N' else 'U' end	as	PROD_CMPLT_INVC_FLAG	,
CASE WHEN ROUND(ITEMLEDGERENTRY.APPLIEDENTRYTOADJUST,0)=1 then 'Y'  WHEN ROUND(ITEMLEDGERENTRY.APPLIEDENTRYTOADJUST,0)=0 then 'N' else 'U' end	as	APPLIED_ENTR_FLAG	,
CASE WHEN ROUND(ITEMLEDGERENTRY.CORRECTION,0)=1 then 'Y'  WHEN ROUND(ITEMLEDGERENTRY.CORRECTION,0)=0 then 'N' else 'U' end	as	CRCTD_FLAG	,
CASE WHEN ROUND(ITEMLEDGERENTRY.POSITIVE,0)=1 then 'Y'  WHEN ROUND(ITEMLEDGERENTRY.POSITIVE,0)=0 then 'N' else 'U' end	as	POSITIVE_FLAG	,
---ITEMLEDGERENTRY.CORRECTION	as	CRCTD_FLAG	,
---ITEMLEDGERENTRY.POSITIVE	as	POSITIVE_FLAG	,
ITEMLEDGERENTRY.SOURCETYPE	as	SRC_TYP	,
CASE WHEN ROUND(ITEMLEDGERENTRY.DROPSHIPMENT,0)=1 then 'Y'  WHEN ROUND(ITEMLEDGERENTRY.DROPSHIPMENT,0)=0 then 'N' else 'U' end	as	DRP_SHIP_FLAG	,
---ITEMLEDGERENTRY.DROPSHIPMENT	as	DRP_SHIP_FLAG	,
ITEMLEDGERENTRY.WARRANTYDATE	as	PROD_SVC_WRNTY_DTE	,
ITEMLEDGERENTRY.EXPIRATIONDATE	as	PROD_SVC_EXPR_DTE	,
ITEMLEDGERENTRY.ITEMTRACKING	as	PROD_TRK_CD	,
ITEMLEDGERENTRY.RETURNREASONCODE	as	ENTR_RESN_CD	
FROM {{source('NAVISIONHY','ITEMLEDGERENTRY')}} ITEMLEDGERENTRY