SELECT
UPPER(CONCAT(COALESCE(PHYSINVENTORYLEDGERENTRY.COMPANY::VARCHAR,''),'~',COALESCE(PHYSINVENTORYLEDGERENTRY.ENTRY_NO::VARCHAR,''))) AS PHY_INVTY_KEY,
'NAVISIONHY' AS {{var('column_srcsyskey')}},
MD5(UPPER(CONCAT(COALESCE(PHYSINVENTORYLEDGERENTRY.COMPANY::VARCHAR,''),'~',COALESCE(PHYSINVENTORYLEDGERENTRY.ENTRY_NO::VARCHAR,'')))) AS {{var('column_rechashkey')}},
{{var('default_n')}} AS {{var('column_DEL_FROM_SRC_FLAG')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
PHYSINVENTORYLEDGERENTRY.LOADDTS AS {{var('column_z3loddtm')}},
PHYSINVENTORYLEDGERENTRY.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
PHYSINVENTORYLEDGERENTRY.ENTRY_NO AS ENTR_NBR,
case when length(trim(UPPER(PHYSINVENTORYLEDGERENTRY.ITEM_NO)))<1 then {{var('default_mapkey')}} when UPPER (PHYSINVENTORYLEDGERENTRY.ITEM_NO) IS NULL then  {{var('default_mapkey')}} else UPPER (PHYSINVENTORYLEDGERENTRY.ITEM_NO) end AS PHY_INVTY_PROD_KEY,
PHYSINVENTORYLEDGERENTRY.POSTING_DATE AS POST_DTE,
case when length(trim(UPPER(PHYSINVENTORYLEDGERENTRY.ENTRY_TYPE)))<1 then {{var('default_mapkey')}} when UPPER( PHYSINVENTORYLEDGERENTRY.ENTRY_TYPE)  IS NULL then  {{var('default_mapkey')}} else UPPER(PHYSINVENTORYLEDGERENTRY.ENTRY_TYPE) end AS ENTR_TYP_LKEY,
PHYSINVENTORYLEDGERENTRY.DOCUMENT_NO AS PHY_INVTY_DOC_NBR,
PHYSINVENTORYLEDGERENTRY.LOCATION_CODE AS LOC_CD_LKEY,
case when length(trim(UPPER(PHYSINVENTORYLEDGERENTRY.INVENTORY_POSTING_GROUP)))<1 then {{var('default_mapkey')}} when UPPER( PHYSINVENTORYLEDGERENTRY.INVENTORY_POSTING_GROUP)  IS NULL then  {{var('default_mapkey')}} else UPPER(PHYSINVENTORYLEDGERENTRY.INVENTORY_POSTING_GROUP) end AS INVTY_POST_GRP_LKEY,
PHYSINVENTORYLEDGERENTRY.QUANTITY AS LEDGER_ENTR_QTY,
case when length(trim(UPPER(PHYSINVENTORYLEDGERENTRY.UNIT_AMOUNT)))<1 then {{var('default_mapkey')}} when UPPER (PHYSINVENTORYLEDGERENTRY.UNIT_AMOUNT) IS NULL then  {{var('default_mapkey')}} else UPPER (PHYSINVENTORYLEDGERENTRY.UNIT_AMOUNT) end AS LEDGER_ENTR_AMT_UOM_KEY,
PHYSINVENTORYLEDGERENTRY.UNIT_COST AS UNIT_COST,
PHYSINVENTORYLEDGERENTRY.AMOUNT AS LEDGER_ENTR_AMT,
case when length(trim(UPPER(PHYSINVENTORYLEDGERENTRY.GLOBAL_DIMENSION_1_CODE)))<1 then {{var('default_mapkey')}} when UPPER( PHYSINVENTORYLEDGERENTRY.GLOBAL_DIMENSION_1_CODE)  IS NULL then  {{var('default_mapkey')}} else UPPER(PHYSINVENTORYLEDGERENTRY.GLOBAL_DIMENSION_1_CODE) end AS GLB_DIM_CD_LKEY,
PHYSINVENTORYLEDGERENTRY.JOURNAL_BATCH_NAME AS JRNL_BATCH_NAME,
PHYSINVENTORYLEDGERENTRY.QTY_PHYS_INVENTORY AS CNT_QTY,
PHYSINVENTORYLEDGERENTRY.LAST_ITEM_LEDGER_ENTRY_NO AS LAST_ITEM_LEDGER_ENTR_NBR,
PHYSINVENTORYLEDGERENTRY.DOCUMENT_DATE AS PROD_DOC_YR,
case when length(trim(UPPER(PHYSINVENTORYLEDGERENTRY.UNIT_OF_MEASURE_CODE)))<1 then {{var('default_mapkey')}} when UPPER (PHYSINVENTORYLEDGERENTRY.UNIT_OF_MEASURE_CODE) IS NULL then  {{var('default_mapkey')}} else UPPER (PHYSINVENTORYLEDGERENTRY.UNIT_OF_MEASURE_CODE) end AS PROD_UOM_KEY,
case when length(trim(UPPER(PHYSINVENTORYLEDGERENTRY.PHYS_INVT_COUNTING_PERIOD_TYPE)))<1 then {{var('default_mapkey')}} when UPPER( PHYSINVENTORYLEDGERENTRY.PHYS_INVT_COUNTING_PERIOD_TYPE)  IS NULL then  {{var('default_mapkey')}} else UPPER(PHYSINVENTORYLEDGERENTRY.PHYS_INVT_COUNTING_PERIOD_TYPE) end AS CNT_PERD_TYP_LKEY,
case when length(trim(UPPER(PHYSINVENTORYLEDGERENTRY.DIMENSION_SET_ID)))<1 then {{var('default_mapkey')}} when UPPER (PHYSINVENTORYLEDGERENTRY.DIMENSION_SET_ID) IS NULL then  {{var('default_mapkey')}} else UPPER (PHYSINVENTORYLEDGERENTRY.DIMENSION_SET_ID) end AS DIM_SET_ID_KEY,
PHYSINVENTORYLEDGERENTRY.QTY_CALCULATED AS ON_HAND_QTY,
PHYSINVENTORYLEDGERENTRY.QTY_PHYS_INVENTORY AS PHY_INVTY_QTY,
PHYSINVENTORYLEDGERENTRY.SOURCE_CODE AS JRNL_REF_CD,
PHYSINVENTORYLEDGERENTRY.GLOBAL_DIMENSION_2_CODE AS GLB_DIM_CD,
PHYSINVENTORYLEDGERENTRY.REASON_CODE AS RESN_CD,
PHYSINVENTORYLEDGERENTRY.DESCRIPTION AS PROD_DESC
FROM {{source('NAVISIONHY','PHYSINVENTORYLEDGERENTRY')}} PHYSINVENTORYLEDGERENTRY