SELECT
UPPER(concat(COALESCE(LTAP.TANUM,''),'~',COALESCE(LTAP.TAPOS,''),'~',COALESCE(LTAP.LGNUM,''))) AS WHSE_TRNSFR_ORD_LN_KEY,
case when UPPER(concat(coalesce(LTAP.LGNUM::VARCHAR,''),'~',coalesce(LTAP.TANUM::VARCHAR,''))) = '~' then {{var('default_mapkey')}}
    else UPPER(concat(coalesce(LTAP.LGNUM::VARCHAR,''),'~',coalesce(LTAP.TANUM::VARCHAR,''))) end as WHSE_TRNSFR_ORD_HDR_KEY,
'SAPP10' AS {{var('column_srcsyskey')}},
MD5(UPPER(concat(COALESCE(LTAP.TANUM,''),'~',COALESCE(LTAP.TAPOS,''),'~',COALESCE(LTAP.LGNUM,'')))) AS {{var('column_redhashkey')}},
{{var('default_n')}} AS {{var('column_delfromsrcflag')}},
'{{model.name}}' AS {{var('column_ETL_INS_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_INS_DTE')}},
'{{model.name}}' AS {{var('column_ETL_UPD_PID')}},
CURRENT_TIMESTAMP::TIMESTAMP_NTZ AS {{var('column_ETL_UPD_DTE')}},
LTAP.LOADDTS AS {{var('column_z3loddtm')}},
LTAP.LOADDTS AS {{var('column_vereffdte')}},
'9999-12-31 00:00:00.000' AS {{var('column_verexpirydt')}},
{{var('default_y')}} AS {{var('column_currrecflag')}},
{{var('default_n')}} AS {{var('column_orprecflag')}},
case when length(trim(UPPER((LTAP.WIRME)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.WIRME)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.WIRME) end AS ACTV_INGREDIENT_UOM_LKEY,
LTAP.RISTM AS ACT_RTRN_STOCKKEEPING_UNIT_QTY,
try_to_decimal(LTAP.VSUMM) AS ALL_STORG_UNIT_RCRD_CNT,
LTAP.RISTA AS ACT_RTRN_ALT_UNIT_QTY,
case when length(trim(UPPER((LTAP.ALTME)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.ALTME)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.ALTME) end AS ALT_UOM_KEY,
case when length(trim(UPPER((LTAP.MEINS)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.MEINS)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.MEINS) end AS BASE_UOM_KEY,
LTAP.CHARG AS BATCH_NBR,
CASE WHEN (LTAP.NBLCH = '1' OR UPPER(LTAP.NBLCH) = 'X') THEN 'Y' ELSE 'N' END AS BLOCKS_WITH_MIXED_BATCHES_FLAG,
CASE WHEN (LTAP.VBLCH  = '1' OR UPPER(LTAP.VBLCH ) = 'X') THEN 'Y' ELSE 'N' END  AS BLOCKS_WITH_MIXED_BATCHES_SRC_FLAG,
case when length(trim(UPPER((LTAP.NKAPA)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.NKAPA)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.NKAPA) end AS CAPACITY_CHK_FOR_DEST_STORG_TYP_LKEY,
case when length(trim(UPPER((LTAP.RKAPA)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.RKAPA)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.RKAPA) end AS CAPACITY_CHK_RTRN_STORG_TYP_LKEY,
LTAP.ZEUGN AS CERTIFICATE_NBR,
CASE WHEN LTAP.KZECH = 'X' THEN 'Y' ELSE 'N' END AS CONFIRM_BATCH_PRODTN_PLNG_FLAG,
CASE WHEN LTAP.PQUIT = 'X' THEN 'Y' ELSE 'N' END AS CNFRM_CMPLT_FLAG,
CASE WHEN LTAP.PASSD = 'X' THEN 'Y' ELSE 'N' END AS CNFRM_DATA_TRANSFERRED_DLV_FLAG,
CASE WHEN LTAP.QUSUB = 'X' THEN 'Y' ELSE 'N' END AS CNFRM_FLAG,
CASE WHEN LTAP.KZQUI = 'X' THEN 'Y' ELSE 'N' END AS CNFRM_REQ_FLAG,
LTAP.QZEIT AS CNFRM_TM,
CASE WHEN LTAP.KZXDK = 'X' THEN 'Y' ELSE 'N' END AS CROSS_DOCK_INTERFACE_TYP_FLAG,
LTAP.DCNUM AS CROSS_DOCKING_DECISION_NBR,
LTAP.UMREN AS ALT_UOM_DENOM_VAL,
LTAP.NISTA AS DEST_ACT_ALT_UNIT_QTY,
LTAP.NDIFA AS DEST_DIFF_ALT_UNIT_QTY,
LTAP.NDIFM AS DEST_DIFF_STOCKKEEPING_UNIT_QTY,
CASE WHEN LTAP.NPLEI = 'X' THEN 'Y' ELSE 'N' END AS DEST_STORG_BIN_CHANGEABLE_FLAG,
--case when length(trim(UPPER((LTAP.NLPLA)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.NLPLA)
--IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.NLPLA) end AS DEST_STORG_BIN_LOC_KEY,
LTAP.NLPLA AS DEST_STORG_BIN_LOC_ID,
LTAP.NPPOS AS DEST_STORG_BIN_PSTN_ID,
case when length(trim(UPPER((LTAP.NLTYP)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.NLTYP)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.NLTYP) end AS DEST_STORG_TYP_LKEY,
LTAP.NLENR AS DEST_STORG_UNIT_NAME,
case when length(trim(UPPER((LTAP.NLEST)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.NLEST)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.NLEST) end AS DEST_STORG_UNIT_STAT_LKEY,
CASE WHEN (LTAP.NDUMM = '1' OR UPPER(LTAP.NDUMM) = 'X') THEN 'Y' ELSE 'N' END  AS DEST_PSEUDO_SU_FLAG,
LTAP.NLBER AS DEST_SUB_LOC_NAME,
LTAP.NSOLA AS DEST_TGT_ALT_UNIT_QTY,
case when length(trim(UPPER((LTAP.DLPLA)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.DLPLA)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.DLPLA) end AS DIFF_POST_TO_STORG_BIN_LOC_KEY,
CASE WHEN LTAP.VKDYN = 'X' THEN 'Y' ELSE 'N' END AS DYN_STORG_BIN_FLAG,
CASE WHEN LTAP.NKDYN = 'X' THEN 'Y' ELSE 'N' END AS DYN_STORG_BIN_TYP_FLAG,
CASE WHEN LTAP.TOVAS = 'X' THEN 'Y' ELSE 'N' END AS GENERAL_FLAG,
CASE WHEN LTAP.ZRSTG = 'X' THEN 'Y' ELSE 'N' END AS MIXED_CRNCY_PROC_FLAG,
TRY_TO_DATE(LTAP.WDATU,'YYYYMMDD') AS GOODS_RCPT_DTE,
LTAP.WENUM AS GOODS_RCPT_NBR,
case when length(trim(UPPER((LTAP.WEPOS)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.WEPOS)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.WEPOS) end AS GOODS_RCPT_PROD_KEY,
case when length(trim(UPPER((LTAP.WEMPF)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.WEMPF)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.WEMPF) end AS GOODS_RCPNT_PARTY_KEY,
CASE WHEN LTAP.FHUTA = 'X' THEN 'Y' ELSE 'N' END AS HDLNG_UNIT_TRNSFR_ORD_LN_FLAG,
case when length(trim(UPPER((LTAP.STOFF)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.STOFF)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.STOFF) end AS HAZARDOUS_PROD_KEY,
LTAP.DIFF_INSP_GUID::VARCHAR AS DIFF_INSPCT_GUID_NBR,
LTAP.FROM_INSP_GUID::VARCHAR AS SRC_GUID,
LTAP.RETURN_INSP_GUID::VARCHAR AS RTRN_INSPCT_GUID_NBR,
LTAP.TO_INSP_GUID::VARCHAR AS DEST_GUID,
LTAP.QPLOS AS INSPCT_LOT_NBR,
case when length(trim(UPPER((LTAP.KZINV)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.KZINV)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.KZINV) end AS INVTY_MVMNT_MTHD_LKEY,
CASE WHEN LTAP.KBNKZ = 'X' THEN 'Y' ELSE 'N' END AS KANBAN_MATL_REPL_FLAG,
case when length(trim(UPPER((LTAP.WERKS)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.WERKS)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.WERKS) end AS LOC_KEY,
CASE WHEN LTAP.PVQUI = 'X' THEN 'Y' ELSE 'N' END AS MATL_PICK_CNFRM_FLAG,
CASE WHEN LTAP.VNEST = 'X' THEN 'Y' ELSE 'N' END AS NESTED_HU_SRC_STORG_UNIT_FLAG,
CASE WHEN LTAP.NOLIS = 'X' THEN 'Y' ELSE 'N' END AS WHSE_CTRL_UPD_FLAG,
LTAP.ORPOS AS ORIG_TRNSFR_ORD_PROD_NBR,
case when length(trim(UPPER((LTAP.VHILM)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.VHILM)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.VHILM) end AS PKG_MATL_TYP_LKEY,
CASE WHEN LTAP.PCKPF = 'X' THEN 'Y' ELSE 'N' END AS PKG_CTRL_FLAG,
CASE WHEN LTAP.VANBR = 'X' THEN 'Y' ELSE 'N' END AS PRTL_PAL_QTY_FLAG,
CASE WHEN LTAP.NANBR = 'X' THEN 'Y' ELSE 'N' END AS PRTL_QTY_TRNSFR_FLAG,
CASE WHEN LTAP.NAPPC = 'X' THEN 'Y' ELSE 'N' END AS PASS_DEST_PROD_TO_APPC_FLAG,
CASE WHEN LTAP.RAPPC = 'X' THEN 'Y' ELSE 'N' END AS PASS_ON_RTRN_PROD_FLAG,
CASE WHEN LTAP.VAPPC = 'X' THEN 'Y' ELSE 'N' END AS PASS_SRC_ITEM_TO_APPC_INTERFACE_FLAG,
CASE WHEN (LTAP.KZSUB = '1' OR UPPER(LTAP.KZSUB) = 'X') THEN 'Y' ELSE 'N' END  AS PASS_TRNSFR_ORD_TO_SUBSYS_FLAG,
TRY_TO_DATE(LTAP.EDATU,'YYYYMMDD') as CNFRM_DTE,
case when length(trim(UPPER((LTAP.KOBER)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.KOBER)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.KOBER) end AS PICK_AREA_SUB_LOC_KEY,
CASE WHEN LTAP.NPIPO = 'X' THEN 'Y' ELSE 'N' END AS TRNSFR_STORG_UNIT_TO_PICK_POINT_FLAG,
CASE WHEN LTAP.LELAS = 'X' THEN 'Y' ELSE 'N' END AS PRINT_STORG_UNIT_CONTENTS_FLAG,
LTAP.LDEST AS PRINTER_NAME,
CASE WHEN (LTAP.KZDIF = '1' OR UPPER(LTAP.KZDIF) = 'X') THEN 'Y' ELSE 'N' END  AS PROD_CAUSE_FLAG,
CASE WHEN LTAP.KZFME = 'X' THEN 'Y' ELSE 'N' END AS DEGREE_OF_CMPLT_FLAG,
LTAP.VBELN AS PROD_DLV_NBR,
LTAP.MAKTX AS PROD_DESC,
LTAP.DLQNR AS PROD_DIFF_IN_QTY,
LTAP.NXIDV AS PROD_EXTNL_HDLNG_NBR,
LTAP.BRGEW AS PROD_GRS_WGT,
case when length(trim(UPPER((LTAP.MATNR)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.MATNR)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.MATNR) end AS PROD_KEY,
LTAP.MBPOS AS PROD_DOC_NBR,
LTAP.POSNR AS PROD_SD_DOC_NBR,
LTAP.TBPOS AS TRNSFR_REQ_ITEM,
LTAP.ENAME AS PROD_PICK_CNFRM_USER_ID,
LTAP.EZEIT AS PROD_PICK_TM,
CASE WHEN (LTAP.KZFEH = '1' OR UPPER(LTAP.KZFEH) = 'X') THEN 'Y' ELSE 'N' END  AS PROD_PRE_ALLOC_FLAG,
case when length(trim(UPPER((LTAP.RSART)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.RSART)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.RSART) end AS PROD_RCRD_TYP_LKEY,
CASE WHEN LTAP.KZNKO = 'X' THEN 'Y' ELSE 'N' END AS PROD_STK_STORG_BIN_FLAG,
TRY_TO_DATE(LTAP.QDATU,'YYYYMMDD') as PROD_TRNSFR_CNFRM_DTE,
LTAP.QNAME AS PROD_TRNSFR_CNFRM_USER_NAME,
CASE WHEN LTAP.DRUCK = 'X' THEN 'Y' ELSE 'N' END AS PROD_TRNSFR_ORD_PRINTED_FLAG,
LTAP.IMREL AS PROD_TRG_POST_ORD_NBR,
--case when length(trim(UPPER((LTAP.ABLAD)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.ABLAD)
--IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.ABLAD) end AS PROD_UNLD_LOC_KEY,
LTAP.ABLAD AS PROD_UNLD_LOC_ID,
LTAP.VOLUM AS PROD_VOL,
case when length(trim(UPPER((LTAP.VOLEH)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.VOLEH)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.VOLEH) end AS PROD_VOL_UOM_KEY,
case when length(trim(UPPER((LTAP.GEWEI)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.GEWEI)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.GEWEI) end AS PROD_WGT_UNIT_OF_MEAS_LKEY,
case when length(trim(UPPER((LTAP.DLTYP)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.DLTYP)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.DLTYP) end AS QTY_DIFF_STORG_TYP_LKEY,
LTAP.DLENR AS QTY_DIFF_SUB_LOC_NAME,
LTAP.DMENG AS INTERIM_STORG_BIN_DIFF_QTY,
LTAP.DMENA AS STORG_BIN_DIFF_QTY,
LTAP.UMREZ AS ALT_UOM_NUMERAT_VAL,
CASE WHEN LTAP.KZTRM = 'X' THEN 'Y' ELSE 'N' END AS RELVNT_PROD_TRNSFR_ORD_FLAG,
UPPER(LTAP.RSPOS)   AS RSRV_REQ_PROD_ID,
LTAP.RDIFM AS RTRN_DIFF_STOCKKEEPING_UNIT_QTY,
LTAP.RSOLA AS RTRN_TGT_ALT_UNIT_QTY,
LTAP.RSOLM AS RTRN_TGT_STOCKKEEPING_UNIT_QTY,
CASE WHEN LTAP.KZSTI = 'X' THEN 'Y' ELSE 'N' END AS TRNSFR_INSPCT_SAMPLE_FLAG,
LTAP.LANUM AS SEQ_NBR,
TRY_TO_DATE(LTAP.VFDAT,'YYYYMMDD') as SHELF_LIFE_EXPR_DTE,
LTAP.VISTA AS SRC_ACT_ALT_UNIT_QTY,
LTAP.VISTM AS SRC_ACT_STOCKKEEPING_UNIT_QTY,
CASE WHEN (LTAP.HUPIK = '1' OR UPPER(LTAP.HUPIK) = 'X') THEN 'Y' ELSE 'N' END  AS SRC_HU_AS_PICK_HU_FLAG,
LTAP.VDIFA AS SRC_STORG_BIN_DIFF_ALT_UNIT_QTY,
LTAP.VDIFM AS SRC_STORG_BIN_DIFF_STOCKKEEPING_UNIT_QTY,
case when length(trim(UPPER((LTAP.VLPLA)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.VLPLA)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.VLPLA) end AS SRC_STORG_BIN_LOC_KEY,
LTAP.VPPOS AS SRC_STORG_BIN_PSTN_LOC_ID,
case when length(trim(UPPER((LTAP.VKAPA)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.VKAPA)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.VKAPA) end AS SRC_STORG_CAPACITY_CHK_TYP_LKEY,
case when length(trim(UPPER((LTAP.VLTYP)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.VLTYP)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.VLTYP) end AS SRC_STORG_TYP_LKEY,
LTAP.VLENR AS SRC_STORG_UNIT_NAME,
case when length(trim(UPPER((LTAP.VLEST)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.VLEST)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.VLEST) end AS SRC_STORG_UNIT_STAT_LKEY,
CASE WHEN LTAP.VSERI = 'X' THEN 'Y' ELSE 'N' END AS HDLNG_UNIT_FLAG,
CASE WHEN LTAP.VDUMM = 'X' THEN 'Y' ELSE 'N' END AS SRC_SU_PSEUDO_SU_FLAG,
LTAP.VLBER AS SRC_SUB_LOC_NAME,
LTAP.VSOLA AS SRC_TGT_ALT_UNIT_QTY,
LTAP.VSOLM AS SRC_TGT_STOCKKEEPING_UNIT_QTY,
LTAP.SOBKZ AS SPCL_STK_TYP,
LTAP.SONUM AS SPCL_STK_NBR,
case when length(trim(UPPER((LTAP.BESTQ)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.BESTQ)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.BESTQ) end AS STK_CTGY_LKEY,
CASE WHEN LTAP.HOMVE = 'X' THEN 'Y' ELSE 'N' END AS STK_REMOVAL_OF_HOMOGENOUS_STORG_UNIT_FLAG,
CASE WHEN LTAP.KZBEF = 'X' THEN 'Y' ELSE 'N' END AS STK_TRNSFR_ORD_FLAG,
LTAP.NISTM AS DEST_ACT_STOCKKEEPING_UNIT_QTY,
LTAP.NSOLM AS DEST_TGT_STOCKKEEPING_UNIT_QTY,
try_to_decimal(LTAP.NSUMM) AS STORG_DEST_TOT_CNT,
CASE WHEN LTAP.KGVNQ = 'X' THEN 'Y' ELSE 'N' END AS SEPARATE_CNFRM_POSBL_FLAG,
case when length(trim(UPPER((LTAP.LGORT)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.LGORT)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.LGORT) end AS STORG_SUB_LOC_KEY,
case when length(trim(UPPER((LTAP.LETYP)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.LETYP)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.LETYP) end AS STORG_UNIT_TYP_LKEY,
LTAP.VANZL AS STORG_UNITS_TO_BE_TRANSFERRED_QTY,
LTAP.RLBER AS SURPLUS_MATL_STORG_AREA_DESC,
LTAP.RPPOS AS SURPLUS_MATL_STORG_BIN_PSTN_DESC,
case when length(trim(UPPER((LTAP.LETYP)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.LETYP)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.LETYP) end AS SURPLUS_MATL_STORG_TYP_LKEY,
LTAP.IVNUM AS SYS_INVTY_RCRD_NBR,
CASE WHEN LTAP.PIPAR = 'X' THEN 'Y' ELSE 'N' END AS ASGN_TO_HDLNG_UNIT_REQ_FLAG,
LTAP.TANUM AS TRNSFR_ORD_NBR,
try_to_timestamp(LTAP.ZEIEI) AS TRNSFR_ORD_PROC_TM,
LTAP.STOAN AS TRNSFR_ORD_CNCL_RQST_NBR,
LTAP.TAPOS AS TRNSFR_ORD_PROD_NBR,
LTAP.SOLPO::TIMESTAMP_NTZ AS TRNSFR_ORD_PROD_PROC_TM,
case when length(trim(UPPER((LTAP.POSTY)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.POSTY)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.POSTY) end AS TRNSFR_ORD_PROD_TYP_LKEY,
case when length(trim(UPPER((LTAP.VORGA)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.VORGA)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.VORGA) end AS TRNSFR_PROC_LKEY,
LTAP.NWIRM AS TRANSFERRED_INGREDIENT_QTY,
LTAP.VKAPV AS TRANSFERRED_MATL_CAPACITY_USAGE_VAL,
LTAP.NANZL AS TRANSFERRED_UNIT_BULK_STORG_QTY,
case when length(trim(UPPER((LTAP.L2SKR)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.L2SKR)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.L2SKR) end AS TWO_STEP_PICK_RELEVANCE_LKEY,
LTAP.QPLOA AS USAGE_DECISION_INSPCT_LOT_NBR,
case when length(trim(UPPER((LTAP.KZVAS)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.KZVAS)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.KZVAS) end AS VAL_ADD_SVC_INTERFACE_TYP_LKEY,
--case when length(trim(UPPER((LTAP.NLQNR)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.NLQNR)
--IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.NLQNR) end AS WHSE_CTGY_MATL_KEY,
LTAP.NLQNR AS WHSE_TGT_BIN_QUANT_NBR,
LTAP.VLQNR AS WHSE_PUTAWAY_BIN_QUANT_NBR,
LTAP.RLQNR AS WHSE_PICK_BIN_QUANT_NBR,
--ase when length(trim(UPPER((LTAP.LGNUM)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.LGNUM)
--IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.LGNUM) end AS WHSE_LOC_KEY,
LTAP.LGNUM AS WHSE_LOC_ID,
case when length(trim(UPPER((LTAP.NULKO)))) <1 then {{var('default_mapkey')}} when UPPER(LTAP.NULKO)
IS NULL then {{var('default_mapkey')}} else UPPER(LTAP.NULKO) end AS ZERO_STK_CHK_STAT_LKEY
FROM {{source('SAPP10','LTAP')}}  LTAP 
WHERE LTAP.MANDT={{var('sapp10mandtftr')}}